<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2019-01-18" />

<title>Vignette Title</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Vignette Title</h1>
<h4 class="author"><em>Vignette Author</em></h4>
<h4 class="date"><em>2019-01-18</em></h4>



<p>Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The <code>html_vignette</code> output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The <code>html_vignette</code> format:</p>
<ul>
<li>Never uses retina figures</li>
<li>Has a smaller default figure size</li>
<li>Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style</li>
</ul>
<div id="vignette-info" class="section level2">
<h2>Vignette Info</h2>
<p>Note the various macros within the <code>vignette</code> section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the <code>title</code> field and the <code>\VignetteIndexEntry</code> to match the title of your vignette.</p>
</div>
<div id="styles" class="section level2">
<h2>Styles</h2>
<p>The <code>html_vignette</code> template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:</p>
<pre><code>output: 
  rmarkdown::html_vignette:
    css: mystyles.css</code></pre>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<p>The figure sizes have been customised so that you can easily put two images side-by-side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="kw">plot</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>You can enable figure captions by <code>fig_caption: yes</code> in YAML:</p>
<pre><code>output:
  rmarkdown::html_vignette:
    fig_caption: yes</code></pre>
<p>Then you can use the chunk option <code>fig.cap = &quot;Your figure caption.&quot;</code> in <strong>knitr</strong>.</p>
</div>
<div id="more-examples" class="section level2">
<h2>More Examples</h2>
<p>You can write math expressions, e.g. <span class="math inline">\(Y = X\beta + \epsilon\)</span>, footnotes<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, and tables, e.g. using <code>knitr::kable()</code>.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Also a quote using <code>&gt;</code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Homework1 ##example1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)
y&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)
<span class="kw">plot</span>(x,y,<span class="dt">xlab=</span><span class="st">&quot;10 random values&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;10 other values&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ##example2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">square &lt;-<span class="st"> </span><span class="cf">function</span>(x)  x<span class="op">^</span><span class="dv">2</span>
<span class="kw">square</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
<span class="co">#&gt; [1]  1  4  9 16 25</span>

is.min &lt;-<span class="st"> </span><span class="cf">function</span>(x)      x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(x) 

a =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)
<span class="kw">is.min</span>(a) 
<span class="co">#&gt;  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
a[<span class="kw">is.min</span>(a)]                                            
<span class="co">#&gt; [1] 0.1790606</span>
<span class="kw">which</span>(<span class="kw">is.min</span>(a))                                  
<span class="co">#&gt; [1] 2</span></code></pre></div>
</div>
<div id="example3" class="section level2">
<h2>example3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;u&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>)
lookup &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">m =</span> <span class="st">&quot;Male&quot;</span>, <span class="dt">f =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">u =</span> <span class="ot">NA</span>)
lookup[x]
<span class="co">#&gt;        m        f        u        f        f        m        m </span>
<span class="co">#&gt;   &quot;Male&quot; &quot;Female&quot;       NA &quot;Female&quot; &quot;Female&quot;   &quot;Male&quot;   &quot;Male&quot;</span></code></pre></div>
<p>Homework2 exercise3.5</p>
<p>Question ： Using inverse transform method to generate a random sample.Then construct afrequeny table and compare with the theory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">U=<span class="kw">runif</span>(<span class="dv">1000</span>)<span class="co">#随机数</span>
X =<span class="st"> </span><span class="dv">0</span><span class="op">*</span><span class="kw">I</span>(U<span class="op">&lt;=</span><span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="kw">I</span>( U<span class="op">&gt;</span><span class="fl">0.1</span> <span class="op">&amp;</span><span class="st"> </span>U<span class="op">&lt;=</span><span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">I</span>( U<span class="op">&gt;</span><span class="fl">0.3</span> <span class="op">&amp;</span><span class="st"> </span>U<span class="op">&lt;=</span><span class="fl">0.5</span>)<span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="kw">I</span>( U<span class="op">&gt;</span><span class="fl">0.5</span> <span class="op">&amp;</span><span class="st"> </span>U<span class="op">&lt;=</span><span class="fl">0.7</span>)<span class="op">+</span><span class="dv">4</span><span class="op">*</span><span class="kw">I</span>( U<span class="op">&gt;</span><span class="fl">0.7</span> <span class="op">&amp;</span><span class="st"> </span>U<span class="op">&lt;=</span><span class="dv">1</span>)<span class="co">#逆函数</span>
<span class="kw">hist</span>(X, <span class="dt">breaks=</span><span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>) ,<span class="dt">main =</span> <span class="st">&quot;c(0.1,0.2,0.2,0.2,0.3)&quot;</span>,<span class="dt">freq=</span><span class="ot">FALSE</span>)<span class="co">#图 </span>
fy&lt;-<span class="cf">function</span>(x)  <span class="fl">0.1</span><span class="op">*</span><span class="kw">I</span>(x<span class="op">&lt;=</span><span class="dv">0</span><span class="op">&amp;</span>x<span class="op">&gt;-</span><span class="dv">1</span>)<span class="op">+</span><span class="fl">0.2</span><span class="op">*</span><span class="kw">I</span>(x<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;</span>x<span class="op">&lt;=</span><span class="dv">3</span>)<span class="op">+</span><span class="fl">0.3</span><span class="op">*</span><span class="kw">I</span>(x<span class="op">&lt;=</span><span class="dv">4</span><span class="op">&amp;</span>x<span class="op">&gt;</span><span class="dv">3</span>) <span class="co">#理论函数</span>
<span class="kw">curve</span>(fy,<span class="dt">from=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">to=</span><span class="dv">4</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)<span class="co">#理论图</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(X)<span class="co">#频率表</span>
<span class="co">#&gt; X</span>
<span class="co">#&gt;   0   1   2   3   4 </span>
<span class="co">#&gt;  97 212 208 187 296</span></code></pre></div>
<p>exercise3.7</p>
<p>Question： Using the acceptance-rejection method to generate random sample of Beta(3,2)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1&lt;-<span class="cf">function</span>(x)
{
t&lt;-x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)
t
}<span class="co">#cdf of beta(3,2)</span>
rej1&lt;-<span class="cf">function</span>(n)
{
   xvec&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>);
   u&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>);
   zvec&lt;-xvec[u<span class="op">&lt;</span>(<span class="kw">f1</span>(xvec)<span class="op">/</span><span class="dv">2</span>)]
   zvec
}<span class="co">#acceptance-rejection method</span>
<span class="kw">NROW</span>(<span class="kw">rej1</span>(<span class="dv">5000</span>))<span class="co">#efficient</span>
<span class="co">#&gt; [1] 2458</span>
samp1&lt;-<span class="kw">rej1</span>(<span class="dv">5000</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>]<span class="co">#getting 1000 random number</span>
<span class="kw">hist</span>(samp1,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.02</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>),<span class="dt">border=</span><span class="st">&quot;yellow&quot;</span>)
<span class="kw">curve</span>(f1,<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">1</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>) <span class="co">#plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>exercise3.12</p>
<p>Question：simulate a continous Exponential-Gamma mixture</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a&lt;-<span class="kw">rgamma</span>(<span class="dv">1000</span>,<span class="dv">4</span>,<span class="dv">2</span>)
b=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)
{
  b[i]&lt;-<span class="kw">rexp</span>(<span class="dv">1</span>,a[i])
}
<span class="kw">hist</span>(b,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="kw">min</span>(b)<span class="op">-</span><span class="dv">1</span>,<span class="kw">max</span>(b)<span class="op">+</span><span class="dv">1</span>,<span class="fl">0.05</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="dt">border=</span><span class="st">&quot;green&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Homework3 6.9 Let X be a non-negative random variable with μ=E[X]&lt;∞μ=E[X]&lt;∞.For a random sample x1,…,xnx1,…,xn from the distribution of X, the Gini ratio is defined by G=12n2μ∑nj=1∑ni=1|xi−xj|. The Gini ratio is applied in economics to measure inequality in income distribution.Note that G can be written in terms of the order statistics x(i)x(i) as G=12n2μ∑ni=1(2i−n−1)x(i)G=12n2μ∑ni=1(2i−n−1)x(i). If the mean is unknown,let G<sup>G</sup> be the statistic G with μμ replaced by x¯x¯.Estimate by simulation the mean,median and deciles of G<sup>G</sup> if X is standard lognoraml.Repeat the procedure for the uniform distribution and Bernoulli(0,1). Also construct density histograms of the replicates in each case.</p>
<p>Analysis: we use definition to solve the problem.lognormal,ubiform,bernoulli. standard lognormal</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">500</span>
m=<span class="dv">1000</span>
v&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span>n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>

t&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
 x&lt;-<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n))
 meanx&lt;-<span class="kw">mean</span>(x)
 t[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="fl">0.5</span>)))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}</code></pre></div>
<p>mean</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(t)
<span class="co">#&gt; [1] 0.5188549</span></code></pre></div>
<p>median</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(t)
<span class="co">#&gt; [1] 0.516295</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(t, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))
<span class="co">#&gt;       10%       20%       30%       40%       50%       60%       70% </span>
<span class="co">#&gt; 0.4624419 0.4794767 0.4929714 0.5064108 0.5162950 0.5270807 0.5383981 </span>
<span class="co">#&gt;       80%       90% </span>
<span class="co">#&gt; 0.5548248 0.5792189</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(t,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))
<span class="kw">lines</span>(<span class="kw">density</span>(t),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYA/wA6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///88jcoBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJt0lEQVR4nO2d6WKcNhhFcRLXuG662HXaxOlq0tbtZKlxbN7/yYoQm0DiAhKSmN7zw5kZf/5AJ5IQIDRJQSZJQu9A7FAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAD4KebpLTe/nvWfum9+s//nG9wXfnSfKto+zBBX2+fuZaUJ6UXDrK7lvQiCxxLuiQnNw6yx6oBr2/SJKTb+5ECUpEIT6+SpLnP1SV6+ldkry4rcpWlvXX6+TZXfHxuox7WZb78So5+3iRnLwu3p+XUd1m2gRVSqmozb6eMIIOSVLvelOE+hMRWIaIEl50H5/e5/LXZbFLQZILtfBdgj0KaqgFiVpwX3yoOgrZCB7Oa2+XVRdydv+UNd5O74p/y7/64l4EXVaCLsXfJq/r+Ip+gh02sYGgsjQv/qp/K4tQFySTlUq8LkVIQW/qwE9/XogE5eelCfmzMtZPUzTtcueC5Ceyx6mK0LRCUbTmtVLWp5+aBKL2FfXPTlA/wR4FDfugz9eyS/m9LoIsb9W63jSv+4KE0Re/fLoyCuonOAZB5QDl54umS51Rg6SJR7OgY6tB8vO3XY9j7oOqslYVo+2kNYL23gcNBJXl/a5qZ9WBR5TGfBRratDp/ecbcx9kOor1Xq4kTA161w5rqvOCqXFQ2wdNdtL9cVDfSr6TcdCoiX0QPdDLu6IeNt/VA+Ef5R+UH319NzqKvfjtUH5kEtRL0BPUZF9PvJc7suFpfxgiFJRV1yrK2qE5tfVPhILq8y7r7tUNEQoqPr86r8/1IyBGQVFBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIAbQe1U+uPz7bhEFOQ3XQRQEICCABQEoCAABQEoCBCnoLTETSZrYhSUSlyksidCQZUbCjIj1cRiKD5BjRkKMtCIiaQKxSYoKb3UV07aF0HHDhEKal62VYiCevQb1g4FZUlyVj2i/cYQ4EDQ+PV+BB2qpSSqp7Iv9RG2ZUlVQamTpFYs2fjTjVgXoXrW9mB4ZNtekPJmZ4Ier8qWlVcLGeTqcgauLtoPDu17E7R9DSqP7Orb1EFSO9b1QZUq63RjBoKKvQna+iiW7l7QxulKH/EKaha5cpRuDalGUGqb1JbexsUKPIauZU26xVQ2kuFnlkmtUTdu7chO0DhBbIKkIoslmyzKom1OkQnKq+PT0836lY2sBGkS6JqdX7qNizVApZl8fRVaXxbDoDAeQY9XLhY0shGkTRCRoO+lH4vqU1iUxXRiGp+gQyhB+gTjsZFn6o1n3fl4kMO8+fJqJIK6GuQo3ULayxzxCgqaLqWgabrrZJEKery6bNeKD9BJp5OC0ggEBU7Xu9A6TkBBypXoiAWJWzmHZN0Ksysv2o/uMesSBL5H3+1QJr6t4KzIrC6bLRQk/+kb0CSIRJC4p5OX5/I+TzV2JygTS1x7F5RCQSEN9ZrY2eOV+NIU701MKb8uQSSCyoGQ+M4Guyv3KwSlexEUIF0tCCWgIJAgaCfU7VDz1QyeO+kUC0riEJS5+Ka4NYJggiRkFeod5m1vGirpZkfPERSyF1LGQQ7TzY7ejSDbA/wg3dzoYesxCQpmqNuh3DinZVW6mdHDkusFBTTUn90R4ii2H0Eh0s0XFM5QYEGjcscsqPrmyWzGwf7h3NhbLRc0I4HmlM0fvU765PYgzubNhtpuytxTHbEgMXFVzGKduh6Uy9uuQWpQKEPKQFEImryiKK4Y6QStvSY9LnS8gpoalE1ftc9Obh3WoHGZzYICDaeHfdABDRcPyWUwQSEMqUexOV8L93D+PIygMIZWjIOebsy1bFk6TYmPQZC7dJoCawU1pAEeYx2ci9l+c+c2grp44yyZzWi2lMlmc7Cca79ox3VNZlLQxDyrzai3lDed88QRakG6eei6FCTI+2Oscku9q2Ue780vFxTgKU25pd4ZmMdbz7sS1DYsf5MXtEdtIMj/U5pBBWmiKahjlSDvz9iFE6SfnQkF+X4AqBEEL4UtSTcL/fzeSAWFSLdWkOfHN4IJMhRzhiC/U6cDCtJGU1CDhSCv1z1CCTJ1tUcqaPlFe9NoZpYgn4YC1SDjcI+CJMYThnmCPBoKI8h8RjVTkL9pi6EEmaLnC/JkKIigias6cwV5a2SBBBmjKUjgQpAvQyEETV16pyBwd2u+IE+GvAnS3R61E+THkD9BzYvJJ3gXCfJiyLug6UecFwva3JBvQej5y7mC2uaaLj9RXoR/QdPRi2qQrEPb3q/3K2jQJuwF9RUdgaAZT64sFlSkLfN2cSHLBMGnEqcEjcvgRFDRd+Te0iJB7eyh3DSNyJDOsPOuBCkbcexqiaDeIsl4PenR7s6bqWAhqD2uTaDd6UmWCDLfoB4casc7mgRAJ6jdxU0EzahBx8fCPqiuQsY+6PhYVuGaSQ7/m/qz1ejqiPAmKEQ37eL0zJ+giMM2TuF0QxQUY9jGKZxuiIJiDNs4hdMNUVCMYRuncLohCooxbOMUxw0FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCbC0oHyxqZVgirR8m705qlxBRsj2cG6L6YXl9/2f1ki0bCxKryuQ9Q7n+pqwS9vClaZkwJSwvM+m/w2G4UUPYPLYVJKc7dAvKVIt9ojDj0gZKmHyjW4pluFG7BVu2FSRXI+r273D6VidIDTuY/ruVMHM9G260/MBiqsXGgqpStFWifKvtg9Sw7KtE/02LSlj+7O+rGWFVQpvFJLYVJHuCpj8QdV8rSAmTq33qFt1Vwg5ioqR2GXV1o7ar9fsUZFzoc1ikQt8RqYJObueEDfMuxmMTq97MaGLyI81aakqY7GNgWGEcWczEYyd9MA5JRt2qvg9WwqQAGGb9fRh+D/OG/04lTJZP13aUMDmjFIb5XddvOaMxm76+K2FV0bQroythokfrTSs1btSuC9r8VOMgR/3t4cbQIShhmfHUQAnLDaOBQZjdsn48WUVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCADsQlFvNzrAlfkG9ldNCQEGA6AWJ+fQhVwSLXhBrEIKCABQEoCAABQEoCGA5EdyW+AUVGcdBMUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+AwmOtAuNdJgSAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
 x&lt;-<span class="kw">sort</span>(<span class="kw">runif</span>(n))
 meanx&lt;-<span class="kw">mean</span>(x)
 t[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(meanx)))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(t)
<span class="co">#&gt; [1] 0.1008395</span>
<span class="kw">median</span>(t)
<span class="co">#&gt; [1] 0.1008685</span>
<span class="kw">quantile</span>(t, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))
<span class="co">#&gt;        10%        20%        30%        40%        50%        60% </span>
<span class="co">#&gt; 0.09749304 0.09868139 0.09953335 0.10019816 0.10086854 0.10151450 </span>
<span class="co">#&gt;        70%        80%        90% </span>
<span class="co">#&gt; 0.10217769 0.10301496 0.10405838</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(t,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))
<span class="kw">lines</span>(<span class="kw">density</span>(t),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYA/wA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///9Qnr9SAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI2UlEQVR4nO2da2ObNhiFlTZZ7DXrLs7Src7WXUK3ZaWXhSTm//+xoQsYDOIYIUDg83xwbEV+ZT0WQgIsREpaEVN/gNChIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCACMI2t2Kiwf997J4Ufr3Xx98F/h+LcT3nqJPLujp5oVvQYnI2HiKPragGpHwLigWZ3feok/Ugj5eCXH23b2sQYasxOc3Qrz8STWu3Xshzu9U3bK6/n4jXtynn2+yfK+zej9fi8vPV+LsbfpxneXaF1MEUCG1oiK6O9MIioUwHz2vgkmRGbMssoZX++SLh0T/O6t2JkhzVa38PsAcBeUYQbIVPKSfVEehN4LHtfG2UV3I5cMuyr1d3Kf/Ze/66kFm2ihBG/le8dbkV5QDzHATOxCU1eb8H/NfXQVTkUg3Kvk8E6EFbU3GL39fyQBZemZCPypj5TBpvl3OXJBO0T2OqkK+Fcqq5c8rdd39mgeQrS81j3tB5QBzFHTYBz3d6C7lT1MFXV+1dW3z52VB0uj5b1+urYLKAZYgKBugvLvKu9QjWpA28WwXtLQWpNN/2fc49j5I1VU1jKKTbhA09z7oQFBW3x/UdqZ2PLI29r1Y3oIuHp5u7X2QbS9WeurINC3ofTGsUfOCtnFQ0Qe1dtLlcVDZSjKTcVBtE/ske6DX96kZNt+bgfDP+g1Z0rf3tb3Y+R9xlmQTVApQEpRHdyfcwx3R4bR/GgIUFKljFVnraJjajk+Agsy8q3f36ocABaVPb9Zmrh8AIQoKCgoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgJEGymNWqtdxaCk5oy5KX1reCFASgIAAFAfwIKi6lt4U7dUEw3PiC8uIoyJZAQSALBYEssxNU8UNB9XQKagtHQSAcBYFwFATCURAIR0Eg3ASCTIEUZE2YmaCqHwqqpVNQazgKAuFORVAkxKX6ifbWkuHEBcVqKQn1q+xNc47TFrS7lesiqN/axpafbFsFHfhZpqDn62zLStRCBkl1OQN80P4kBLEFIYo+SKnqEm4KQdrQXPZiJyLIOdwCBOWLXHkKd5g+f0F6BR5L1+ISrpq+BEGpB0e2j3PoZ66CtKIeSzYtXFCi9k+7W/eVjZYsSK4Bqs0k7k1owYKer30saLRkQT9qPz2aT8vHmUSQKtW7oJiCmiJG+/n4cnbzw7QgT+Gq1PzMUJAfKMgt3OwFPV9virXih+ikZy/IGxTkFm4RguSpnFi4rTCLDtovQlAk71ZwmUa9DpuFJUiW63Euts1m89tBphqrlYfKhiAokktcU5AlYnT5fC1vmjLAJrYMQdlASN6zod+R+yUL8gIFOYVbhqD81gz+O+mmjzlDQZGPO8UFJqip7XaktJvve9KwEq7MUgTZLkhwCldmGYL67uAPwpVZhiA1z+jNggUNd8CscU49P0F+oCCHcFMKajjQ0pFSRHXnyeiInf3j2tpbLVlQcnYXy9m83VDRTdl7qgULkheuyqtY244HJfq0a7cW1HwJwfwEyYGiFNR6RFEeMWoS1HZMeimC8hYUtR+1j87uTrQFmT4oRsPFWGw6CVpNLainoepe7Jjbwj2uX3YT1Jg+lqDeTchhHLS7tbcyCjoqnO6vs9a9kg+Nnff8BOlBTt87d4ricZVTLaZWrj0lLEGR3mzintfalwVpSdViauW2pPgS1M+QiZjknXPLHur4cKL2uaYTVPsRREd0xNLRMh/n5kWtZc9dUGkG5uPUs6g17PkLKjYsHxcv1H7jTEHVcKLWM04oqOd+bChBjeltCRQEEkIXBA+FdQkXmqA+hgaZatQ/0pSC+jWhgQTBYigIFHPSgho2+okF9TA0jCBczJiCejUhP4KqB+0pCIQLUJC7oQEENX2caQX1aUKDCHKviff3WHcbx0JBgNMQ1MOQf0GrEAW590JDCOpVE8/voaAjszhvY94FrcIU5NyEBhDUsyZ+31MM8vNTvNalHi0sX1D+xHoOsx3fglYBC7KcBW/Hv6DGoAEISoMQZLlcKhBBLmuXehfUHDQEQdZvr5UTE9R9pYFu2eGvEm2beRCCtKEhBRVXDyW2y4iEJWgYgpShAQWVFkluX086WEHFdW+1bFa6CLKfoD64kFwEzJCCjmhBy6NjH2SakLUPWh7duqz8IoeTaT/ex0HLY2xB0/bQio4feBgPPsobJuvEUw2f5VHQJFkpyGfe7tl7Q0H+yqOgSbJSkM+83bP3hoKWBgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIMKygpL2lVvIjNE30asvtaIUl1oazHVx/Kqa5RLQwqSK4pU6wrU7wo1ol7/NrplmaVqFKIvsF7nuoY1caQgvTFDmY5meKFXkgFrkh4XFTVcGSYfWq/lRFqDClIr0VklpMpXugvXz7GTttBJaq8jEIZ2ae6RbUyqCDV2M03WrwwgsQ2jb4RDrdUrERN86f7VLeoVoYUtG8r5RfmuxZbvaznMavr2qOqBCmoSHWMamV8QaaTLi416tplAEGOUa2Mv4mpe5a++De/KWfnRdPQJuYW1cr4nbT536v8Sde98kGgXNBBeG/7+vF385pY3u5N1qnzxnAQyEQoUh2jWhl/oKhu0KVHjLKS3bvTg4GikbEfh7pFtTHsVMNMKvQqhOUZhq6fvIGyQ19RiVq0lrhnVAucrAIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgBkISvydaHcgfEGlldOmgIIAwQt6XE+7IljwgtiCEBQEoCAABQEoCEBBgNJ9qKcgfEFpxHFQyFAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/ATIHg/9FjkAgAAAAAElFTkSuQmCC" /><!-- --> 6.10 Construct an approxiamate 95% cinfidence interval for the Gini ratio γ=E[G]γ=E[G] if X is lognormal with unknown parameters.Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
<p>Analysis: Firstly,generating sample of rlnorm(n,a,b).Both a and b is random. Then calculate Giniof the sample and confidence interval ,finally getting the coverage rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
n&lt;-<span class="dv">1000</span>              <span class="co">#generate 1000 random numbers</span>
m&lt;-<span class="dv">100</span>               <span class="co">#generate 100 gini ratio every times             </span>
k=<span class="dv">100</span>                <span class="co">#repeat 100 times</span>
Glnorm&lt;-<span class="dv">1</span><span class="op">:</span>m
gamma.hat&lt;-sdgamma.hat&lt;-cpgamma&lt;-<span class="dv">1</span><span class="op">:</span>k
v&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span>n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>

<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)
{
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
  a=<span class="kw">runif</span>(<span class="dv">1</span>)<span class="co">#random mean</span>
  b=<span class="kw">runif</span>(<span class="dv">1</span>)<span class="co">#random sd</span>

  x&lt;-<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n,a,b))
  meanx&lt;-<span class="kw">mean</span>(x)
  Glnorm[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(meanx)))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}
  gamma.hat[j]&lt;-<span class="kw">mean</span>(Glnorm)
  sdgamma.hat[j]&lt;-<span class="kw">sd</span>(Glnorm)
  cpgamma[j]&lt;-(<span class="dv">1</span><span class="op">/</span>m)<span class="op">*</span><span class="kw">sum</span>(<span class="kw">I</span>(gamma.hat[j]<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.975</span>,m<span class="op">-</span><span class="dv">2</span>)<span class="op">*</span>sdgamma.hat[j]<span class="op">&lt;</span>Glnorm <span class="op">&amp;</span><span class="st"> </span>Glnorm<span class="op">&lt;</span>gamma.hat[j]<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.975</span>,m<span class="op">-</span><span class="dv">2</span>)<span class="op">*</span>sdgamma.hat[j]))
}</code></pre></div>
<p>the coverage rate</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(cpgamma)
<span class="co">#&gt; [1] 0.9726</span></code></pre></div>
<p>6.B Tests for association based in Pearson product moment correlationρρ,Spearman’s rank correlation coefficient ρsρs,or Kendall’s coefficient ττ,are implemented in cor.test.Show that the nonparametric tests based onρρ or ττ are less powerful tha the corelation test when the sampled distribution is bivariate noraml.Find an example of an alternative(a bivariate distribution (X,Y) such that X and Y are dependent )such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
<p>Analysis: we use three methods to test the correlation and situmulate the empirically power.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(1)</span>
alpha=<span class="fl">0.1</span>
m&lt;-<span class="dv">2500</span>
n=<span class="dv">100</span>
test1&lt;-test2&lt;-test3&lt;-<span class="kw">numeric</span>(m)
<span class="co">#estimate</span>
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
u1=<span class="kw">runif</span>(<span class="dv">1</span>)
sd1=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">5</span>)
u2=<span class="kw">runif</span>(<span class="dv">2</span>)
sd2=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>)
x&lt;-<span class="kw">rnorm</span>(n,u1,sd1)
y&lt;-<span class="kw">rnorm</span>(n,u2,sd2)
test1[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#pearson</span>
test2[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#spearman</span>
test3[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#kendall</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(test1)
<span class="co">#&gt; [1] 0.1004</span>
<span class="kw">mean</span>(test2)
<span class="co">#&gt; [1] 0.0984</span>
<span class="kw">mean</span>(test3)
<span class="co">#&gt; [1] 0.0972</span></code></pre></div>
<p>we select the uniform distribution #(2)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test1&lt;-test2&lt;-test3&lt;-<span class="kw">numeric</span>(m)
m=<span class="dv">1000</span>
n=<span class="dv">100</span>
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
  x&lt;-y&lt;-<span class="kw">numeric</span>(n)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
  {
    x[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)
    t=x[i]
    y[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>t<span class="op">^</span><span class="dv">2</span>),<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>t<span class="op">^</span><span class="dv">2</span>))
  }
  test1[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#pearson</span>
  test2[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#spearman</span>
  test3[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)<span class="co">#kendall</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(test1)
<span class="co">#&gt; [1] 0.0148</span>
<span class="kw">mean</span>(test2)
<span class="co">#&gt; [1] 0.02</span>
<span class="kw">mean</span>(test3)
<span class="co">#&gt; [1] 0.0104</span></code></pre></div>
<p>Homework4 ## Question 1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
LSAT=law<span class="op">$</span>LSAT
GPA=law<span class="op">$</span>GPA
n =<span class="st"> </span><span class="kw">length</span>( LSAT ) <span class="co">#numbeer of data</span>
cor_jack =<span class="st"> </span><span class="kw">numeric</span>( n )
cor_hat =<span class="st"> </span><span class="kw">cor</span>( LSAT,GPA ) <span class="co">#corelation of LSAT  and GPA</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { cor_jack[i] =<span class="st"> </span><span class="kw">cor</span>( LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i] ) }
bias_jack =<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>( <span class="kw">mean</span>(cor_jack) <span class="op">-</span><span class="st"> </span>cor_hat )
cor_bar =<span class="st"> </span><span class="kw">mean</span>(cor_jack) <span class="co"># mean of statistic generated from jackknife</span>
se_jack =<span class="st"> </span><span class="kw">sqrt</span>( (n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>( (cor_jack<span class="op">-</span>cor_bar)<span class="op">^</span><span class="dv">2</span> ) ) 

<span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">'estimate of the bias  of the correlation statistic is: %f'</span>,bias_jack ))
<span class="co">#&gt; [1] &quot;estimate of the bias  of the correlation statistic is: -0.006474&quot;</span>

<span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">'estimate of the standard error of the correlation statistic is: %f'</span>,se_jack ))
<span class="co">#&gt; [1] &quot;estimate of the standard error of the correlation statistic is: 0.142519&quot;</span></code></pre></div>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">attach</span>(aircondit)
x =<span class="st"> </span>hours
B =<span class="st"> </span><span class="dv">5000</span> 
<span class="kw">set.seed</span>(<span class="dv">1</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gaptime_hat =<span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#MLE of 1/lambda</span>
<span class="co">#bootstrap estimate of 1/lambda</span>
frac_1_lambda_boot =<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>aircondit,<span class="dt">statistic=</span><span class="cf">function</span>(x,i){<span class="kw">mean</span>(x[i,])}, <span class="dt">R=</span>B )

frac_1_lambda_boot
<span class="co">#&gt; </span>
<span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; boot(data = aircondit, statistic = function(x, i) {</span>
<span class="co">#&gt;     mean(x[i, ])</span>
<span class="co">#&gt; }, R = B)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrap Statistics :</span>
<span class="co">#&gt;     original  bias    std. error</span>
<span class="co">#&gt; t1* 108.0833  0.2438    37.77646</span></code></pre></div>
<p>We see the MLE is 1/lambda = 108.0833, with estimated std. error = 37.77646, bias = 0.2438.</p>
<p>Next we try to calculate the bootstrap intervals by the standard normal, basic, percentile, and BCa methods.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">einf_jack =<span class="st"> </span><span class="kw">empinf</span>(frac_1_lambda_boot, <span class="dt">type=</span><span class="st">'jack'</span>)
<span class="kw">boot.ci</span>( frac_1_lambda_boot, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">'norm'</span>,<span class="st">'basic'</span>,<span class="st">'perc'</span>,<span class="st">'bca'</span>), <span class="dt">L=</span>einf_jack ) 
<span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span>
<span class="co">#&gt; Based on 5000 bootstrap replicates</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; CALL : </span>
<span class="co">#&gt; boot.ci(boot.out = frac_1_lambda_boot, type = c(&quot;norm&quot;, &quot;basic&quot;, </span>
<span class="co">#&gt;     &quot;perc&quot;, &quot;bca&quot;), L = einf_jack)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Intervals : </span>
<span class="co">#&gt; Level      Normal              Basic         </span>
<span class="co">#&gt; 95%   ( 33.8, 181.9 )   ( 25.8, 170.5 )  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Level     Percentile            BCa          </span>
<span class="co">#&gt; 95%   ( 45.7, 190.3 )   ( 54.9, 222.2 )  </span>
<span class="co">#&gt; Calculations and Intervals on Original Scale</span></code></pre></div>
<p>We see the intervals are quite different. A primary reason is that the bootstrap distribution is still skewed, affecting the simpler methods and their appeal to the Central Limit Theorem. For example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(frac_1_lambda_boot<span class="op">$</span>t, <span class="dt">main=</span><span class="st">''</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="dv">1</span><span class="op">/</span>lambda), <span class="dt">prob=</span>T)
<span class="kw">points</span>(frac_1_lambda_boot<span class="op">$</span>t0, <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The BCa interval incorporates an acceleration adjustment for skew, and may be preferred here.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
<span class="kw">attach</span>( scor )
n =<span class="st"> </span><span class="kw">length</span>( scor[,<span class="dv">1</span>] )
x =<span class="st"> </span><span class="kw">as.matrix</span>(scor)
theta_jack =<span class="st"> </span><span class="kw">numeric</span>( n )</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda_hat =<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values
theta_hat =<span class="st"> </span>lambda_hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda_hat) <span class="co">#compute the mean of theta from sample</span>
<span class="co">#according to the formala, we write a function to calculate the theta. </span>
theta =<span class="st"> </span><span class="cf">function</span>(x){
 <span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values)
}  

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { theta_jack[i] =<span class="st"> </span><span class="kw">theta</span>( x[<span class="op">-</span>i,] ) }

theta_bar =<span class="st"> </span><span class="kw">mean</span>(theta_jack)
bias_jack =<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>( <span class="kw">mean</span>(theta_jack) <span class="op">-</span><span class="st"> </span>theta_hat )
se_jack =<span class="st"> </span><span class="kw">sqrt</span>( (n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>( (theta_jack<span class="op">-</span>theta_bar)<span class="op">^</span><span class="dv">2</span> ) )

<span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">'the jackknife estimates of bias of hat of theta is : %f'</span>, bias_jack))
<span class="co">#&gt; [1] &quot;the jackknife estimates of bias of hat of theta is : 0.001069&quot;</span>
<span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">'the jackknife estimates of standard error of hat of theta is : %f'</span>, se_jack))
<span class="co">#&gt; [1] &quot;the jackknife estimates of standard error of hat of theta is : 0.049552&quot;</span>
<span class="kw">detach</span>(scor)</code></pre></div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>The code to estimate the parameters of the four models follows. Plots of the predicted response with the data are also constructed for each model and shown follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)
<span class="co">#&gt; 载入需要的程辑包：lattice</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 载入程辑包：'lattice'</span>
<span class="co">#&gt; The following object is masked from 'package:boot':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     melanoma</span>
<span class="kw">attach</span>(ironslag)
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span>

L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
<span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>
<span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkLaQtpCQttuQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/9u2///bkDrbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///+HKtyXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL5klEQVR4nO2dDZfjphWGmcls7TZf7TjbJG2zk3RX269sR9mkI6/t//+7KkBgJAEvIJBk+77n7I5sXV+Jx3AB6RqxE8krtvQJrF0ECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQJaDNDx458ZY1/88IJNK3b/bPfxj+fT8Ym9CvCRrKUAHV4zqYcP0NYF6NPr+6sF1BZLyVE7DLkAOWtWTi0EqGbsjreuj1vGHlVRDzu+ffrIK9eX77jZ8f2WPbwVe2t29/fX7P7DeXcl8P63q0G/fM7YZz/kP9NlALUV6E4Q4FDa8pmAGlmx+H5dzwQgrlcv5909QJV8+zH7qS4DqEWx6TYrWVYNqIXyu5fTftux2rwc3ytArz6cfjN3i0/JGNRa/unl065Am1sGkCygUD0AxPXrv9r2sjFangT0pvtIb7cEJC3rr3/OfqrrA3T8UbaWDS+7qGcqBsmwpHcbgAp2ZYs2sfqPvGhtKSUggY3HnYeffuUGqiGagIzdfUAb/xGTtWSQbgHcfcvOLUQAkpVLsFH1wgRk7L7mGiS7+Xak1/U8svQN325ErDGisI5BAtBotxmDmi/fZj/ThQC1hVbiX33N0Xx6YrIGvXrhmxvVi1WsX4P0bvGW7sVEc9WBPJuWmmp8UlMNdvcX0W2rcYwe+/CgUpnjIB2D1O5mPA7KH4mWnqx+J4fS+5bX1//RvdjD21q0meM/t+3weNSLdbv5COnhZ3Mk/df857n45Y7j+69KzjUna3FAaxcBAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAooDpFIHZki/XYuiANUqca4pkE66UsUAOj5pLHXR7PY1KQbQYafTk5qbaWSZaxC7GJUA1Magrgo5Y9D6O8WOTRlAOrXQGYFWD0jVnkKA5naXXbp9zQwovmkvpHkA7bfOZNvbBmQkN7vG0msHVDgGdZ3XBdeg8r0Y778uGlCnYjGountHgLxqJ6wEyKv99jMC5NXxyf2bmksBVGguNru7YiJAfpWazc/uDh8vZXJT7nLH7O7g4ZKmfwtMVku5Q0dLmiAvMZsv5Q4dLQXQLV0PSgFUdi42tzt4uFg+2v5GAEX3YtqcrihaxZYCVMpdZhlfIAGyyKzgKYAqscTDtJvuq4hBjpbeezsBUCVudh12k1Z3WEMv5oiF/TfjAakb79Puuq9gHGTvLYZvxQNSN97rawU0eB18DL0lb7zvt5OC0EKAeuHXAsiCMfgY502xRk23el+qlolBfSJWPqNPBh8i6oRgCt4ivdiwzuD6UwoQTsFbZBwEBvH2Pi3YecSJhCRQRbjLJj8g+55IQIfdo77x7u7FAlLwlhlJx/O5rRrkm9S79iQMFL+R/ZdvoHhhKXi+lpcOyDtQvKgUPH/kDvYi/6j1+NjEFYdXBAiE7mA3akPVoCkns6oLZrkBhavxjLevGpBYHLzytrC2JT7uv3oxO/zE4xYXGj0G+9Fbzd27tvNuR0RuY37JqBK1Z2Xd/Ficja/Fp13u4MX29GKi3ux/LxblXclAsc9Av/JOzeSbwUdQG7z0HJBnHCRr1/F/p9XUIMc0HkzuxbvBh1AbqgZVnh866drlbIhLXjDTr3pAHLEoOQbV3hWZa9l9NU6jNQAaNbtclzvEMPmiLphZAQ1oZASUQ8vHoBGMXDEojxbvxWwsMl0wy/KL5kXHQTFznQRAVY6foS4JKGo2mDIOyvFL7wUBxU2X0waK0zUbIHss7gPKPdXI8ciFuQDZevPhm9knqzke2jEToGFlYZqPkQHkbXEpTYyl92L2MVo5jVlY38wKKI+WAKS2CJB5nB6f8ZuWlwMHwUdSG8YvdifEotl7sWEostlYPx98IL0l73W1oXrKiKgEIG85U8NeejfPL3mkr31TAJCnpUzoFdIHis3984QsvPyA3LF2Uq+ZdkWRi9eg+QDhImpAfdOpg4opMWjKmDrylANKqQCNR4aTamvyFUX+yEp3BcqcYRY0uDT4jC8/J6vMOCh3hllYOVUD06Z6PBJ1sIHT7IanAvlBw3J6xjGGKTMAJVNKAKRGinNmmHkDi32nBjNOb406crxh1XZfG9+6HCUyzByVxPLyNAIzqaWlXVFs+K1n343DfBlmlnIBQOZbDkARsNIGivs/PIt/TmXLMLN98wiQQcQOKKY6pQ0UeRKVF1Cu41rbhh9Qj4w1BkU1uISqxsfP1WPaIqSx8SAakNo0G1n3vt+p8wzCzHqG1aZ77rRbNesuhrhmI1kAjVloYx+E4oCwavEMdPGk+IndvLUog3bT4+P9YMC+1BNNGCgenzxpVhl6sXNFMIJOWE8VzqfsQLFyT/gnjf4tgJgLUASLaSdq9GIwOuuBYrWZA5D8MwA0aIbpB4s2DLmzqrC4Y/m0k+4F5VGF0ibjapVwrGhDYx7hlhpKH5/iAQUU6Nx8VgioS1+dKG8ADSqRLvz6AG3lUcvkB4UVqWdlDTc9eCVO1GlYOHkBF2lcLZitw2JGmCpxok7Dwukvukj9UrNBf+5zbZtVJFMqFKQnHLffYMw/Ea3P4S3riToNcwZp24mPiERF26Hh1JaW0sS6w2UI0g4MLo2cWMpsNZ0VUB71Q2waIBe0awPkMBAl8gFyV6vAN/OcaLSh34uzudhM/eM9lyOr81Q+661BnVkCoLxaOSBvNz0Hn9UD8nbTM/BZFlBwAedpTfZDZzcMdxde6NsEFFPqxfhcCqBZwo39wNkNg92ltJv5ORUCFJRhlsRnbkJlAAVmmCXxmZlQEUClVqC6GkCl1jC7GkDF1jC7ohhUaA0zO5+S1Ar1YrOuYVa0Xq1+shrgqmhkWu8Fs1if+Rz2vWc3nN0dAYK+Li4Gzf2c1cvrxZxZL2nullSxySrIcGAXozKAApdnCHGaySbXocp8eIpTAjSPDQGa6VBlPjzFKQGax4YAzXSoMh+e4pQAzWNzmYCuSQQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgSUG1C3uo7vEVudjbwNab2NJFIhH71+tInHDV+LRT0pJfmBIZkBHXbi1mLTnk7jOqXOxv0Lx+NT+9GaF9rp52zi+aEkXwdBfNp7OkB5ATXynrRMRavsX2tn43nKklxHrS2e24828bgRi/byW53e00HKCqhhj+J8z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
<span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))
<span class="kw">plot</span>(<span class="kw">log</span>(chemical), <span class="kw">log</span>(magnetic), <span class="dt">main=</span><span class="st">&quot;Log-Log&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)
<span class="kw">lines</span>(<span class="kw">log</span>(a), logyhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Once the model is estimated, we want to assess the fit. Cross validation can be used to estimate the prediction errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) 
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
k=<span class="dv">1</span>
<span class="co"># fit models on leave-two-out samples</span>

<span class="cf">while</span> (k<span class="op">&lt;</span>n) {
    y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>))]
    x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>))]

    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
    e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1
    
    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>
<span class="st">    </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span>
    e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2
    
    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
    e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3
    
    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])
    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)
    e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
    
    k=k<span class="op">+</span><span class="dv">2</span>
}</code></pre></div>
<p>The following estimates for prediction error are obtained from the leave two out cross validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))
<span class="co">#&gt; [1] 8.505391 6.762961 7.362525 8.780626</span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L2
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = magnetic ~ chemical + I(chemical^2))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;   (Intercept)       chemical  I(chemical^2)  </span>
<span class="co">#&gt;      24.49262       -1.39334        0.05452</span></code></pre></div>
<p>The fitted regression equation for Model 2 is <span class="math display">\[ \hat{Y} = 24.49262 - 1.39334X + 0.05452X^2\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co">#layout for graphs</span>
<span class="kw">plot</span>(L2<span class="op">$</span>fit, L2<span class="op">$</span>res) <span class="co">#residuals vs fitted values</span>
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co">#reference line</span>
<span class="kw">qqnorm</span>(L2<span class="op">$</span>res) <span class="co">#normal probability plot</span>
<span class="kw">qqline</span>(L2<span class="op">$</span>res) <span class="co">#reference line</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co">#restore display</span></code></pre></div>
<p>Homework5 ## Question</p>
<ul>
<li><p>8.1 Implement the two-sample Cram′ er-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p></li>
<li><p>8.2 Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations： 1. Unequal variances and equal expectations 2.Unequal variances and unequal expectations 3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) 4.Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>9.3 Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchyor qt with df=1). Recall that a Cauchy(θ,η) distribution has density function</p></li>
</ul>
<p><span class="math display">\[{f(x)}=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0\]</span></p>
<p>The standard Cauchy has the Cauchy(θ = 1,η = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<ul>
<li>9.6 Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125,18,20,34). Assume that the probabilities of the corresponding multinomial distribution are</li>
</ul>
<p><span class="math display">\[\left(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4}\right)\]</span></p>
<p>Estimate the posterior distribution of <span class="math inline">\(θ\)</span> given the observed sample, using one of the methods in this chapter.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>8.1</p>
<p>The variables in this question:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">158</span>, <span class="dv">171</span> ,<span class="dv">193</span> ,<span class="dv">199</span> ,<span class="dv">230</span> ,<span class="dv">243</span> ,<span class="dv">248</span> ,<span class="dv">248</span> ,<span class="dv">250</span> ,<span class="dv">267</span> ,<span class="dv">271</span> ,<span class="dv">316</span> ,<span class="dv">327</span> ,<span class="dv">329</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">141</span> ,<span class="dv">148</span> ,<span class="dv">169</span> ,<span class="dv">181</span> ,<span class="dv">203</span> ,<span class="dv">213</span> ,<span class="dv">229</span> ,<span class="dv">244</span> ,<span class="dv">257</span> ,<span class="dv">260</span> ,<span class="dv">271</span> ,<span class="dv">309</span>)
<span class="co">#the function cvm.test is used to calculate the Cramer-von Mises statistic</span>
cvm.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){
  <span class="co">#the empirical distribution function of the x,y</span>
  F &lt;-<span class="st"> </span><span class="kw">ecdf</span>(x)
  G &lt;-<span class="st"> </span><span class="kw">ecdf</span>(y)
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  m &lt;-<span class="st"> </span><span class="kw">length</span>(y)
  s &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
  t &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
  <span class="cf">for</span> (i  <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
    s[i] &lt;-<span class="st"> </span>(<span class="kw">F</span>(x[i])<span class="op">-</span><span class="kw">G</span>(x[i]))<span class="op">^</span><span class="dv">2</span>
  }
  s &lt;-<span class="st"> </span><span class="kw">sum</span>(s)
  <span class="cf">for</span> (j  <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {
    t[j] &lt;-<span class="st"> </span>(<span class="kw">F</span>(y[j])<span class="op">-</span><span class="kw">G</span>(y[j]))<span class="op">^</span><span class="dv">2</span>
  }
  t &lt;-<span class="st"> </span><span class="kw">sum</span>(t)
  <span class="co">#return the Cramer-von Mises statistic</span>
  <span class="kw">return</span> (m<span class="op">*</span>n<span class="op">*</span>(s<span class="op">+</span>t)<span class="op">/</span>(m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>)
}
<span class="co">#number of replicates</span>
R &lt;-<span class="st"> </span><span class="dv">999</span> 
<span class="co">#pooled sample</span>
z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)
K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">26</span>
<span class="co">#storage for replicates</span>
reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) </code></pre></div>
<p>From the book,we know that the Cramer-von Mises statistic is definded as <span class="math display">\[\frac{m+n}{(m+n)^2}\left[\sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right]\]</span>. The role of the above function is used to seek the statistic .And the code is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t0 &lt;-<span class="st"> </span><span class="kw">cvm.test</span>(x, y)
t0
<span class="co">#&gt; [1] 0.1515216</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {
  <span class="co">#generate indices k for the first sample</span>
  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
  x1 &lt;-<span class="st"> </span>z[k]
  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span>
  reps[i] &lt;-<span class="st"> </span><span class="kw">cvm.test</span>(x1, y1)
}
p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(t0, reps) <span class="op">&gt;=</span><span class="st"> </span>t0)
p
<span class="co">#&gt; [1] 0.421</span>
<span class="kw">hist</span>(reps, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;T (p = 0.421)&quot;</span>,
<span class="dt">breaks =</span> <span class="st">&quot;scott&quot;</span>)
<span class="kw">points</span>(t0, <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>) </code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see,the result used by the Cramer-von Mises statistic is 0.1515216.The approximate ASL 0.421 does not support the alternative hypothesis that distributions differ.The result is the same as the conclusion used by the Kolmogorov-Smirnov (K-S) statistic.</p>
<p>8.2</p>
<p>The variables in this question:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(RANN)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(Ball)
m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">50</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
  z &lt;-<span class="st"> </span>z[ix, ];
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}
<span class="co">#the nn method and return the p.values</span>
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}

p.values1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
p.values2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
p.values3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
p.values4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</code></pre></div>
<p>In this question,we should design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.Each situation is simaliar. And the code is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#under the situation of unequal variances and equal expectations</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  <span class="co">#the sample x is from the standard normal distribution and the sample y is from the normal diisreibution with mean=0,variance is 2</span>
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span><span class="dv">2</span>),<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span><span class="dv">2</span>));
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values1[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values1[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values1[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;
pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values1<span class="op">&lt;</span>alpha)
<span class="kw">names</span>(pow1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>, <span class="st">'ball '</span>)
<span class="co">#get the powers by the three method</span>
pow1
<span class="co">#&gt;     NN energy  ball  </span>
<span class="co">#&gt;   0.51   0.66   0.95</span>

<span class="co">#under the situation of unequal variances and unequal expectations</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    <span class="co">#the sample x is from the standard normal distribution and the sample y is from the normal diisreibution with mean=0.2 ,variance is 2</span>
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> mu,<span class="dt">sd=</span><span class="dv">2</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">2</span>));
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values2[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values2[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values2[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;
pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values2<span class="op">&lt;</span>alpha)
<span class="kw">names</span>(pow2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>, <span class="st">'ball '</span>)
<span class="co">#get the powers by the three method</span>
pow2
<span class="co">#&gt;     NN energy  ball  </span>
<span class="co">#&gt;   0.55   0.61   0.93</span>

<span class="co">#under the situation of non-normal distributions</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
      <span class="co">#the sample x is from t distribution with df=1 and the sample y is from the mixture of two normal distributions</span>
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol =</span> p);
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">4</span>));
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values3[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values3[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values3[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;
pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values3<span class="op">&lt;</span>alpha)
<span class="kw">names</span>(pow3) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>, <span class="st">'ball '</span>)
<span class="co">#get the powers by the three method</span>
pow3
<span class="co">#&gt;     NN energy  ball  </span>
<span class="co">#&gt;   0.53   0.30   0.33</span>

<span class="co">#under the situation of Unbalanced samples which the number of x is 200 and y is 20</span>
n1 &lt;-<span class="st"> </span><span class="dv">200</span>
n2 &lt;-<span class="st"> </span><span class="dv">20</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2));  
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values4[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values4[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values4[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.18</span>;
pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values4<span class="op">&lt;</span>alpha)
<span class="kw">names</span>(pow4) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>, <span class="st">'ball '</span>)
<span class="co">#get the powers by the three method</span>
pow4
<span class="co">#&gt;     NN energy  ball  </span>
<span class="co">#&gt;   0.22   0.13   0.15</span></code></pre></div>
<p>In conclusion,under the situations of unequal variances and equal expectations , unequal variances and unequal expectations ,the Ball method is the best and the NN method is the wrost.Under the situation of non-normal distributions,the NN is the best and the rest is very close .Under the situation of Unbalanced samples which the number of x is 200 and y is 20,the NN method is the best.Hence,in different situation,the performance of the three method is different and we need choose the best one.</p>
<p>9.3</p>
<p>The variables in this question:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="co">#build a standard Cauchy distribution</span>
f &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">x0=</span><span class="dv">0</span>, <span class="dt">gamma=</span><span class="dv">1</span>){
  out&lt;-<span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>gamma<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>x0)<span class="op">/</span>gamma)<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">return</span>(out)
  
}
<span class="co">#the times of simulation</span>
m &lt;-<span class="st"> </span><span class="dv">80000</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
<span class="co">#generat the normal proposal distribution with mean=xt ,sd=1</span>
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt,<span class="dt">sd=</span><span class="dv">4</span>)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>xt,<span class="dt">sd=</span><span class="dv">4</span> )
k &lt;-<span class="st"> </span><span class="dv">0</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</code></pre></div>
<p>When we use the Metropolis-Hastings sampler to generate the Markov chain,we should choose a proposal distribution which has the same support set as the target distribution.That is,in this question,the cauchy distribution is supported from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span> so the proposal distribution should also be supported in the same set.Hence,I choose the normal distribution.And the code is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
  xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt,<span class="dt">sd=</span><span class="dv">1</span>)
  num &lt;-<span class="st"> </span><span class="kw">f</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, <span class="dt">mean =</span> y,<span class="dt">sd=</span><span class="dv">4</span>)
  den &lt;-<span class="st"> </span><span class="kw">f</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, <span class="dt">mean =</span> xt,<span class="dt">sd=</span><span class="dv">4</span>)
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
    x[i] &lt;-<span class="st"> </span>xt
    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span>
  }
}
<span class="co">#discard the burnin sample</span>
b &lt;-<span class="st"> </span><span class="dv">1001</span> 
y &lt;-<span class="st"> </span>x[b<span class="op">:</span>m]
a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">200</span>)
<span class="co">#quantiles of cauchy distribution</span>
Qcauchy &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a)
<span class="co">#quantiles of sample distribution</span>
Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(x, a)
<span class="kw">qqplot</span>(Qcauchy, Q,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Q-Q plot for Cauchy distribution&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="dv">50</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">lines</span>(Qcauchy, <span class="kw">f</span>(Qcauchy))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAARVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmADpmtv+QOgCQZgCQ2/+2ZgC2///bkDrb////tmb/25D//7b//9v///+J2iGjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGJUlEQVR4nO3d7XqaSABAYZo0WzfZGmIS7v9SF0SNUeHM8BGG8Zyf+zgjfRcQRmqLynorlt6A1BMIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIISgOoSGQ7bpTGhgkECQQJ1F9Rt/Q2dJXEhhVFukRJbNaeJ4ktuS6JzRIIEgjKH6g4NXh43kAjp9v7CNQzSiAYJRCMEghGCQSjBIJRAsEogWCUQDBKIBglEIwSCEYJBKMEglECwSiBYJRANCp3oLFLrmsA+tgUvyecLnLUCoCqqqx3gD/TTRc1ahVA1QRGuQO1RA+vk00XOmolQLta57n6fHl8m2S6iFFrAKrP0kUrs+vYhT42zeG369vHMgb62Pz6C6/dA5UN4sfmGaaL3Ig1AP3b+nTtPlULdKApO47COwAq+4Hen/ZAXYzZAm2/roW7P+bdg6DmNF7sr7fb03XfdJEbsQKgsGqj+ly+69zN7h5onun2DwclDVQfMu3xM+46Ol+ghacTCEetAaj5ZCqPdxs3Ox2F3QdizkDbx7f3p9/VtmfZ7POFTlAZAzVXgLv6Xr7nVqMRglXHzIG2NU7PrUZV7QlvzTJ+TTp5oPrY+tg8vn1sRq1M5wy0v0jGYyh4urhRawBacLoMgbrOVDkDfb54q3Gjs5P0KJmr6WIGrQKoc4ln2HRRg1YC1LEOfx4ehhkDhXzAl8eFss4Vs4yBui6Sz/p8ObFMuia9DqCABbOzo3DSbzXWARTQfe9BIZXHo/Auz0HNQfb4tu39sD8eh52rajkD7X79LZu7+Z9/PmgdQM0Jpjmz9K8HBU8XNagFSlPo24ViA9S7ohg+XdSgVQAd96Dt8KenqmFAxREoSaHLc1CJl4s3Zxmz5LoWoPYjCp+iCp4ufMxagJaaTiAasw6g9hpw1Bm6GghUrQFo256cy5HP2mcLtDuenA/PII6cLnJM+kBnq2V9382HThc7Jn2gszuwn7/VWAcQLoXFTBc7RiAYIxCMOSx3CNQ1Zg1A+HBdzHSxY9IHWnQ6gXCMQL1DBIIhAsEQgWDIF1CKQtNs05g16bsAGj7d4ZeSBeocUJx9zKcoJBAkEBS3SdM/o/gNKMUP+sjngyZ/RjEroDmeMPuSyQBojmcUL4DSE1p2D9qflvMBmv4ZxWug5IjitmfqZxSLq3PQyoGmnu4aKLnz9IJAxfGxjoyAJr1QLC5lkvx6bLELxdP5+WoPSktooY/5s6PrBlBKQktcKH5bA7oBVA3/G/jT97N70GnZEYDGrVFO2jQXisX6mgWILxTza+k9OPkEggYCjXtQb03NtQctewa+asQfZDqToHk7/nvky6eaJiCBoIlvVnHevIH4ZhXnzRoo4FYD580aKOZZ2LsEcg+i+FsNnDdvoIib1TsFusMEggSCBIIEggSCBIIEggSCBIIEggSCBIKmB9qvW+9XQ3aBP2gV+rpBkx9+lC3iPb43OdDnS70hZfOvkDW/KLML2KrQ1w2avJZpgCLe46LJgdrf1ykfXtv1R/4xmdDXDZq8/XnRqPe4aKZzUP1/6/SHgZeGvm7Q5FX5+F8NFP8ep2YC2j68vv/T7NH8Sxehrxs6eXMOin+PU/MANWvW7SHPB37o64ZM3hxaDVD0e3w1C9DueBqdAyhm8uNPiyYG1H7nMdMhFjP5/lUJHWKHf4z98AX1PCfpqMnLw8Mvz0mdpI9fns3xMR89edXuQSl9zL8/Hb9TnOFCMX7yw5V0QheKh9262Zgy8PI+9HWDJj/caoS/x0XerEICQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJB/wPckENJQ+iQwQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the Q-Q plot and the histogram above,we can see the deciles of the generated observations and the deciles of the standard Cauchy distribution are almost the same.So, the Metropolis-Hastings chain converges to a unique stationary distribution which in this question is the standard cauchy distribution.</p>
<p>9.6</p>
<p>The variables in this question:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">size &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
<span class="co">#The following function prob computes the target density</span>
prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, size) {
  <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;</span><span class="dv">1</span>)
    <span class="kw">return</span> (<span class="dv">0</span>)
  <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">1</span>] <span class="op">*</span>
<span class="st">           </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">3</span>] <span class="op">*</span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">4</span>])
}
<span class="co">#length of the chain</span>
m &lt;-<span class="st"> </span><span class="dv">5000</span>
<span class="co">#width of the uniform support set</span>
w &lt;-<span class="st"> </span>.<span class="dv">25</span> 
<span class="co">#burn-in time</span>
burn &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="co">#for accept/reject step</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) 
<span class="co">#proposal distribution</span>
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="op">-</span>w, w)</code></pre></div>
<p>One approach to estimating <span class="math inline">\(\theta\)</span> is to generate a chain that converges to the posterior distribution and estimate <span class="math inline">\(\theta\)</span> from the generated chain. Use the random walk Metropolis sampler with a uniform proposal distribution to generate the posterior distribution of <span class="math inline">\(\theta\)</span>.And the code is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>.<span class="dv">25</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
  y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i]
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, size) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], size))
    x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span>
      x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}
xb &lt;-<span class="st"> </span>x[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>m]
<span class="kw">print</span>(<span class="kw">mean</span>(xb))
<span class="co">#&gt; [1] 0.6227292</span></code></pre></div>
<p>So,a estimation of the <span class="math inline">\(\theta\)</span> can be 0.6227292.In fact,we can use the mathematical methods to figure out the <span class="math inline">\(\theta\)</span> and the result by mathematical methods is very close to the result above. Homework6 #9.6 The prior of theta could be a uniform distribution U(0,1), and we could easily obtain that there exists a constant C that posterior of theta</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lden=<span class="cf">function</span>(theta)<span class="dv">125</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">+</span>theta)<span class="op">+</span><span class="dv">38</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">+</span><span class="dv">34</span><span class="op">*</span><span class="kw">log</span>(theta)
MCMC=<span class="cf">function</span>(x,<span class="dt">burn_in=</span><span class="dv">0</span>,<span class="dt">N=</span>burn_in<span class="op">+</span><span class="dv">10000</span>,<span class="dt">print_acc=</span>F){
  y=<span class="dv">1</span><span class="op">:</span>N<span class="co">#for MCMC generation</span>
  ld=lden<span class="co">#use log-likelihood, things could be a little bit different.</span>
  acc=<span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    p=<span class="kw">runif</span>(<span class="dv">1</span>)
    y[i]=x=<span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;</span><span class="kw">exp</span>(<span class="kw">ld</span>(p)<span class="op">-</span><span class="kw">ld</span>(x))){acc=acc<span class="op">+</span><span class="dv">1</span>;p}<span class="cf">else</span> x
  }
  <span class="cf">if</span>(print_acc)<span class="kw">print</span>(acc<span class="op">/</span>N)
  y[(burn_in<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]
}
<span class="kw">plot</span>(<span class="kw">MCMC</span>(<span class="fl">0.5</span>,<span class="dt">print_acc=</span>T))<span class="co">#accept rate~0.15</span>
<span class="co">#&gt; [1] 0.1582</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
  <span class="co"># for chain in i-th row of X</span>
  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span>
  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span>
  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span>
  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span>
  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>(n<span class="op">*</span>k)) <span class="co">#upper variance est.</span>
  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span>
  <span class="kw">return</span>(r.hat)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M1=<span class="kw">cumsum</span>((<span class="dt">MC1=</span><span class="kw">MCMC</span>(<span class="fl">0.2</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span><span class="co">#mean_cumsum</span>
M2=<span class="kw">cumsum</span>((<span class="dt">MC2=</span><span class="kw">MCMC</span>(<span class="fl">0.4</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span><span class="co">#mean_cumsum</span>
M3=<span class="kw">cumsum</span>((<span class="dt">MC3=</span><span class="kw">MCMC</span>(<span class="fl">0.6</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span><span class="co">#mean_cumsum</span>
M4=<span class="kw">cumsum</span>((<span class="dt">MC4=</span><span class="kw">MCMC</span>(<span class="fl">0.8</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span><span class="co">#mean_cumsum</span>
psi=<span class="kw">rbind</span>(M1,M2,M3,M4)
<span class="kw">plot</span>((<span class="dt">R=</span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>,<span class="cf">function</span>(i)<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>i]))),<span class="dt">main=</span><span class="st">&quot;R value of Gelman-Rubin method&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOnsAOpAAZpAAZpwAZrYgIQA6AAA6ADo6AGY6OgA6OjE6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmZmZmkLZmkNtmtrZmtttmtv98IQB8OgCQOgCQZgCQZjqQkDqQkGaQkLaQttuQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa227a22/+2/7a2///bkDrbkGbbkJDbtmbbtpDb27bb2//b/9vb////tmb/25D/27b//7b//9v///9lzrT9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMoUlEQVR4nO2dDZvbOBHHve2ysOQo3DWhPV6aIxxw1AfcsoZruXqb5Pt/KPSukV80siTHXmX+z9M+2cSSxr+MRmNZVqqz0nFXGb14PJOUqqUNWLsIECIJ6PgGdir3ryuX8iAWge7lq9OBQhCU7WKtitD7Ba1ZoSgGISJAiCwgFnwoCerLAqqJzJAMoONuu6QdqxUARMPXkAyg0+F+QTPWK5gHkQsNCHQxupQfEuVBiAgQIgKESE137LYUg4ZFHoSIACECgEQnu/u0nC2rVDdRbG7eL2fMGgUuNeTFak0+5Kh3sdrSKOaod7HakAc5gjGI97GWYpArnSjSfecRUR6EiAAhovkgRF0PolG+o14Xq2lq2pEDSN87vPnywVuIHTchWzp9v6mq1/qvD1+zBl6+/l9KjbrIiLG1DRMR9Z5P/2Clm0rlO4OAqsqfDU1rVqyK2HZauHHvECQA6hubBujz2xcBgCpvR5vWbGPPADTgxrokQF1j66SBRpbuA9KjGLfzaaPNVW21YlXMh7fs8y/f69ORn7Fy3DtO37Nv8jU4R96VXv7+E6/Cfsmsnpt37L0fN5VbStTIFyl9eMWOOP9nU92KEqZJbvHf2dG3xls0U2ksNIa9/oG1/tWDPqhbdqAhY0ktvz1TpOtBEkytAUky8u/WOHQfkMJ7a765xuAGgFg5RerpN5yTLaUBSb3SLmab1BU63giMdQEZJ9WA3LL9hqwlBpCqow/ov4/Ag9g796pd9vLnn/hH2wFA7PWD/ExK1tAIP2mgYU5vsKUMoO35R2bWO1kUNMnfuH1QNaIeVN098HruLSCnbK8haL/uYrwOjsl+4y8eQbfemvfZ4eYUP/7rlW0W2KT6WWM6v+qatVMaElR26lIaEKtW/m8OVU1yA/eiBo3YNdYFJBqsdb29sr2GoP0G0F6SlEX4RXx995Np815HE1Z+r76r07c6JPYAsaMcJ9bfrmDTA9Sq3gdKmRik3UweaptUtYgP5dywa2zHnR9V4yYG6bLAk0FD0H4YpA0gMRl03L37Rh52+x3sdffKWGbQ7d8+7jqAxId6faNGoW0RIazXxTQgUGoYEGhyHJA0FhijI+gEQND+QUBicdDp8Gtu9umfztQ9c7u/iINl48dBQNzPQN8Z8yAVpIEH7WGBoS9WNzkICBjrAorwIGP/CCA5Vv1StNbAzEJ4H3+31R1ZB+lGn+22F31HYpAZ5k8f3xogHkCgyd5J6i9BGQuM4UF6f3ZjEAII2u8D9LM/6a8DOAQf9/ZnNVp8Pjhjw/bM35Bx8d3588643vAodgaBlV982FKjHqSbHAWkjHWN4WOSM4ohgKD9jcoqhgD9wo6cNhdl34r4w5ycbtZENpsH2aTf5kEQkK2E2QNLjccg1eQ4IGksNGYgD8IAAftbUdIPiDdhXM7Uy4eU2+/MoMzqZmnuVz/IEfLztxuZu2qJTPoP57MLiA3bX29Uig1LeUYx2eQ4IGUsMGYok0YAAft5Tn37MAyIZjr6okl7RDQnjYgAIeoBaqiLOSIPQkSAEBEgRPQ4FCJ6HAoRPQ6FiB6HQkSPQyGix6EQ0fIXRJQHISJAiCwg3ceoizkCieLdp+b+/LShUO3ISRRbPn9LC8kdOYni068exT+SlfMwy/G37wlQRzYG8anEektdrCMwzNfirjcNYq4oD0JEgBBRoogIjGIUnYdEE2aIeg/1klzZGPT0BT2MOSAAaJMhSFfPRpMB5ZmTrvR/a08fpgPKE6Qtm5UTivGgHEG6YEBJQdrp2oUCynNXo+AYlLPdCYPEUloUEHmQv7oSY1C2ZcClAsraLgHCqis1BolHFOu0dLHkUay9ed/wB0qSCBUMiF9q8Fs+aQvJC+5i/GKVA/Ju/8KfPBKrYccubAsO0tqDfNsEis/lo1YjHbFgQCoGNZ6FeOKCX+4CN3b/tWRAMlv0bfsipoxkFxzriAXHoAAFelCho1iITAwanV0r2IPqezlt752Zvt5R7LgTz3nvU2/+FAuolvsq7c+JNzdKBSRjiljAGZZJjx0lYxCL0SvnM30+SG4+sY/cSLEzaV/eKAYy4+RrsUrySqjkEpocg+zmJ6kxqCpymDfrxxP3kxbuI16snNDkPKiVCZDvUiy0OhWHkuqZXRGZtNhUxrvKLGBqX8AREag8QAE6HbAIrof5tfewuSbt0TTy2gGhz22WmklnbZcAIdURIKy6QmNQll8LLxZQrt+bL7WLHd9AJu5fk9stEVDWdqvnMCG0bJDOX292kQchmj5hlm+VK8UgpLoSPShvuwXGoNRhfmDSfuWEKFFEtOSlRpEelLXdAmNQ1nZL9aBTjp04SwaUZSdOeVdD/7diTQeUZyfOogHle2a1yC6W76nnQj1owk6cno3gCgYUcDUfeuu5zC4WIvmD4lfqQUESaz2vFpBYBYwtD6rZARigQrtYq37mDwnVTbW9Tg/Si+fRbQKfNi+vEpBOFPFVruyi7Rq7WLAHodUV6kGhMUjKt5C8VEBho9hILcXPSedst1gPytWu9aUViwAholvPiGbxoAkLyUvzICa+GzmXL1EMW0heOCDv41BBC8mLBFTbzuOduw9aSF4iIOtB6e1SoohUV2yiyJ98bv09LKi6Uj1Ibvty3KU/Fl6mB4XPB2HVFepBZj4oHVCZHqRmgp42yXuYeT2oAkppKFUXng9yqhvzoKqvpLaStOgwP+xBA3wWRLS6PGgYz3KQIgCdZlxh5sOzDKSYPCjfCrPuKeN8Ls4oJg9KGL6cs+ydbxifyzKKTxTT2+2e7DCFhUHFJIr5Vpg5Jzl64ov6VNSNwwwu1AfkO9sgRPNgiuliypgMlxrgpNCzDIaUl9NaEsWwk5sCKROpldwXCz+lyYwSUa2ji007j1hGUbyiPShtOsgFFPk95wCFNh3fxZI3eRs4weja5pA1NPiMHHldCL1eGwQUastYnXMgigfkm1Fs9JT+6Nz+EKBQUxDlJRQNyDdpDzZJ9u5IPgsf0EYOQvGjmGeJIrhc8+1IPjMfp7kLAgpQjAdNqD5ZMwJivhFy69ms8AyOQaFmzKRRPjELqELuzaP9sAMo1IqLyVg1tYs19qQy/DLLegEZRQTpbKs7zs+Az+wXq9iO5FcPqFuLw4QAIdURIKy69fNZGNAz2Goy4WI1aQEDmKqPruMimsWDQhaSPxvNAeiMLyQPqxT5PO3j1OJJhwfeXSwREDpXKBV2d7FAQPhcYUSlsZ+vEFDATM/0SqM/XyGggLnC6ZVGf75CQORB2OH4XGFEpbGfrxFQyJz99EojP18lINKICBCiiYni9WmWRLEkzTLMl6RZEsWSRB6EaJZEsSTNkiiWJMqDEBEgRJQoIqJEEVH+Yb6NubEmdzUwRfsvPOJLd/bDpaJscZU9UeQ/Fj35B6NbMXqaov0XHjX8GE4orjim3B4ka5q4Gp3lGKxVU7T/wtvg/VipKFu6yp0oyo1wJ27f0Nz9mQEyRfsvPGUNoLjiqHInik9fcI+e1k9ZGR6DTNH+C19p3cUii2PKnQfJLj+p4/OeILbm0UX7L/xNykgcWxzRCgDxqJcAiD/OznccmRlQrkRxuluLEvFdzEacWbtYtkRxemDUK5D3cVHWuMmsQXrhYV56UNw4LSkwN5l1mF86UZSZdFymp2PQM0kUI9fwyUsNU7T/wle2Ups/xhVHRDOKiGhGERFNmCEiQIgIECIChEjnQXaFNc1KO1IeFLpE/PpkL1ZzbEBVoEwMyrIBVYGiII2IACEiQIgIECIDSO/EmTgBV5zIgxARIEQECBEBQkQXq4joYhURXawiootVRBSkEREgRAQIkRrm38AxzP3ryqU8iCVCahQ7HRbOhHqrDVKXH6TJdrFWr9NZ0Bphx1oBrUUECBHjcdz9cSddma9f+SsH1Mg1Lny2Kuk3ZCYLTJhV68ilBSDGhC/v5Yuj2kr9wVdJ8YVMl30mEnhQUyG/QnsZCUBbsbZOLq+r1Rti8Vv74t9ZtgwNltvF1sBIANqLZYFyOaBZ0Ct41Rd29G4Mahaf8ACAGgPIjrCXvmZ0ALXChtNh0WVm4x7EdTr87rLfnwXEJ80kmWUfnQeA1EJn9YZQc/fT4aJBAIxii6YbVgCQelBFjWIyWu8v/P2tNA9SgNw8iIGRC84vGabXB2hlokl7RORBiAgQIgBI9DNaad8RmA8Sw3yzksF+NTKATgeZi9XkQ45soqgukmkHKlc9D6IdqFzBOWk5hbf0nPTKBGcUKVccEOVBiAgQIkoUEVGiiIgSRUSUKCKiRBERJYqIKFFERHkQIgKEyL1xSP2rJwuIJUCN3myPZPR/CKhDn9Wr08MAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res=<span class="kw">which.max</span>(R<span class="op">&lt;</span><span class="fl">1.2</span>)
<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(MC1[res<span class="op">:</span><span class="dv">10000</span>],MC2[res<span class="op">:</span><span class="dv">10000</span>],MC3[res<span class="op">:</span><span class="dv">10000</span>],MC4[res<span class="op">:</span><span class="dv">10000</span>])),<span class="kw">var</span>(<span class="kw">c</span>(MC1[res<span class="op">:</span><span class="dv">10000</span>],MC2[res<span class="op">:</span><span class="dv">10000</span>],MC3[res<span class="op">:</span><span class="dv">10000</span>],MC4[res<span class="op">:</span><span class="dv">10000</span>])))
<span class="co">#&gt; [1] 0.623447416 0.002520016</span></code></pre></div>
</div>
<div id="section" class="section level1">
<h1>11.3</h1>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the kth term in <span class="math display">\[\sum\limits_{k=0}^{\infty} \frac{(-1)^k||a||^{2k+2}\Gamma(\frac{d+1}{2})\Gamma(k+1.5)}{k!2^k(2k+1)(2k+2)\Gamma(k+\frac{d}{2}+1)}\]</span>where <span class="math inline">\(d\geq 1\)</span>is an integer,a is a vector in <span class="math inline">\(R^d\)</span>,and <span class="math inline">\(||.||\)</span>denotes the Euclidean norm.Perform the arithmetic so that the coefficients can be computed for(almost) arbitarily large k and d. (b)Modify the function so that it computes and return the sum. (c)Evaluate the sum when <span class="math inline">\(a=(1,2)^T\)</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
euclidean_norm&lt;-<span class="cf">function</span>(x)
{
    length_x=<span class="kw">length</span>(x)
      y=<span class="dv">0</span>
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>length_x)
        {
            y=y<span class="op">+</span>(x[i])<span class="op">^</span><span class="dv">2</span>
        }
    y=<span class="kw">sqrt</span>(y)
}
factorial&lt;-<span class="cf">function</span>(n)
{
    <span class="cf">if</span>(n<span class="op">==</span><span class="dv">0</span>) {ans=<span class="dv">1</span>}
    <span class="cf">if</span>(n<span class="op">!=</span><span class="dv">0</span>) {ans=<span class="kw">prod</span>(<span class="dv">1</span><span class="op">:</span>n)}
    ans
}</code></pre></div>
</div>
<div id="a" class="section level1">
<h1>(a)</h1>
<p>compue the kth term.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1&lt;-<span class="cf">function</span>(k,x,d)
{
    m=<span class="kw">euclidean_norm</span>(x)
    a=((<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k)<span class="op">*</span>(m)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">+</span><span class="fl">1.5</span>)
    b=<span class="kw">factorial</span>(k)<span class="op">*</span><span class="dv">2</span><span class="op">^</span>k<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>d<span class="op">+</span><span class="dv">1</span>)
    ans=a<span class="op">/</span>b
}</code></pre></div>
<p>when d=1 (c)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)
a=<span class="kw">t</span>(a)
k=<span class="dv">0</span>
t2=<span class="kw">f1</span>(<span class="dv">0</span>,a,<span class="dv">1</span>)
t1=<span class="dv">0</span>
s=t2
<span class="cf">while</span>(<span class="kw">abs</span>(t2<span class="op">-</span>t1)<span class="op">&gt;</span><span class="fl">0.01</span>)
{
    k=k<span class="op">+</span><span class="dv">1</span>
    t1=t2
    t2=<span class="kw">f1</span>(k,a,<span class="dv">1</span>)
    s=s<span class="op">+</span>t2  
}</code></pre></div>
<p>converge to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s
<span class="co">#&gt; [1] 1.813659</span></code></pre></div>
<p>Homework7 Write a function to compute the cdf of the cauchy distribution,which has density<span class="math display">\[\frac{1}{\theta \pi(1+[(x-\eta)/\theta]^2)}\]</span>,where <span class="math inline">\(\theta&gt;0\)</span>.Compare your results to the results from the R function pcauchy. </p>
<p>we use r function integrate to solve the problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f&lt;-<span class="cf">function</span>(y,theta,nita)
{
    <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((y<span class="op">-</span>nita)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}

cauchy_cdf&lt;-<span class="cf">function</span>(theta1,nita1,x)
{
    <span class="kw">integrate</span>(f,<span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>,<span class="dt">upper=</span>x,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span>theta1,<span class="dt">nita=</span>nita1)<span class="op">$</span>value
}</code></pre></div>
<p>we use standard cauchy function to verify.and let x=20.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nita1=<span class="dv">0</span>;
theta1=<span class="dv">1</span>;
x=<span class="dv">20</span>;
<span class="kw">cauchy_cdf</span>(theta1,nita1,x)
<span class="co">#&gt; [1] 0.9840977</span>
<span class="kw">pcauchy</span>(<span class="dv">20</span>)
<span class="co">#&gt; [1] 0.9840977</span></code></pre></div>
<p>A-B-O Blood type problem. Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>Ao</th>
<th>BO</th>
<th>AB</th>
<th>AA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td>p2</td>
<td>q2</td>
<td>r2</td>
<td>2pr</td>
<td>2qr</td>
<td>2pq</td>
<td>1</td>
</tr>
<tr class="even">
<td>count</td>
<td>n_AA</td>
<td>n_BB</td>
<td>n_OO</td>
<td>n_AO</td>
<td>n_BO</td>
<td>n_AB</td>
<td>n</td>
</tr>
</tbody>
</table>
<p>Observed data: nA?= nAA + nAO = 28 (A-type), nB?= nBB + nBO = 24 (B-type), nOO = 41 (O-type), nAB = 70 (AB-type). Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB). Record the maximum likelihood values in M-steps, are they increasing?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ABOexpect=<span class="cf">function</span>(nA,nB,p,q,r) {
    nAA=nA <span class="op">*</span><span class="st"> </span>p <span class="op">/</span><span class="st"> </span>(p <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>r)
    nAO=nA <span class="op">-</span><span class="st"> </span>nAA
    nBB=nB <span class="op">*</span><span class="st"> </span>q <span class="op">/</span><span class="st"> </span>(q <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>r)
    nBO=nB <span class="op">-</span><span class="st"> </span>nBB
    N=<span class="kw">list</span>(<span class="dt">AA=</span>nAA,<span class="dt">AO=</span>nAO,<span class="dt">BB=</span>nBB,<span class="dt">BO=</span>nBO)
  }
  
  ABOmaximize=<span class="cf">function</span>(nAA,nAO,nBB,nBO,nAB,nO) {
    p=(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAA <span class="op">+</span><span class="st"> </span>nAO <span class="op">+</span><span class="st"> </span>nAB) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(nA <span class="op">+</span><span class="st"> </span>nB <span class="op">+</span><span class="st"> </span>nO <span class="op">+</span><span class="st"> </span>nAB))
    q=(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBB <span class="op">+</span><span class="st"> </span>nBO <span class="op">+</span><span class="st"> </span>nAB) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(nA <span class="op">+</span><span class="st"> </span>nB <span class="op">+</span><span class="st"> </span>nO <span class="op">+</span><span class="st"> </span>nAB))
    r=<span class="st"> </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>p <span class="op">-</span><span class="st"> </span>q
    L=<span class="kw">list</span>(<span class="dt">p=</span>p,<span class="dt">q=</span>q,<span class="dt">r=</span>r)
  }
  
  <span class="co">#initial guess</span>
  p=<span class="fl">0.3</span>
  q=<span class="fl">0.2</span>
  r=<span class="fl">0.5</span>
  ## Observed data (counts of people with the four blood groups)
  nA =<span class="dv">28</span>
  nB=<span class="dv">24</span>
  nAB=<span class="dv">41</span>
  nO=<span class="dv">40</span>
  
  ## Set up iteration
  iter=<span class="dv">1</span>
  diff=<span class="dv">1</span>
  tol=<span class="fl">0.0001</span> ## tolerance
  
  <span class="cf">while</span> (diff <span class="op">&gt;</span><span class="st"> </span>tol) {
    E=<span class="kw">ABOexpect</span>(nA,nB,p,q,r)
    M=<span class="kw">ABOmaximize</span>(E<span class="op">$</span>AA,E<span class="op">$</span>AO,E<span class="op">$</span>BB,E<span class="op">$</span>BO,nAB,nO)
    diff=<span class="kw">abs</span>(M<span class="op">$</span>p <span class="op">-</span><span class="st"> </span>p) <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(M<span class="op">$</span>q <span class="op">-</span><span class="st"> </span>q) <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(M<span class="op">$</span>r <span class="op">-</span>r)
    p=M<span class="op">$</span>p
    q=M<span class="op">$</span>q
    r=M<span class="op">$</span>r
    <span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;iter:%d, diff:%.2f</span><span class="ch">\n</span><span class="st">&quot;</span>,iter,diff))
    iter=iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
<span class="co">#&gt; iter:1, diff:0.12</span>
<span class="co">#&gt; iter:2, diff:0.01</span>
<span class="co">#&gt; iter:3, diff:0.00</span>
<span class="co">#&gt; iter:4, diff:0.00</span>
<span class="co">#&gt; iter:5, diff:0.00</span>
  
  <span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;p=%.4f,q=%.4f, r=%.4f</span><span class="ch">\n</span><span class="st">&quot;</span>,p,q,r))
<span class="co">#&gt; p=0.2847,q=0.2649, r=0.4505</span></code></pre></div>
<p>Homework8 1.Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
x&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">9</span>)
y&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">5</span>)
b&lt;-<span class="st"> </span><span class="kw">table</span>(x,y)
<span class="kw">summary</span>(b)
<span class="co">#&gt; Number of cases in table: 4 </span>
<span class="co">#&gt; Number of factors: 2 </span>
<span class="co">#&gt; Test for independence of all factors:</span>
<span class="co">#&gt;  Chisq = 12, df = 9, p-value = 0.2133</span>
<span class="co">#&gt;  Chi-squared approximation may be incorrect</span></code></pre></div>
<p>Homework9 ##Exercises 7.1 (pages 212)</p>
<p><font size="3"> The law school data set law contains LSAT and GPA for 15 law schools.This data set is a random sample from the universe of 82 law schools in law82.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
<th align="right">11</th>
<th align="right">12</th>
<th align="right">13</th>
<th align="right">14</th>
<th align="right">15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LSAT</td>
<td align="right">576.00</td>
<td align="right">635.0</td>
<td align="right">558.00</td>
<td align="right">578.00</td>
<td align="right">666.00</td>
<td align="right">580.00</td>
<td align="right">555</td>
<td align="right">661.00</td>
<td align="right">651.00</td>
<td align="right">605.00</td>
<td align="right">653.00</td>
<td align="right">575.00</td>
<td align="right">545.00</td>
<td align="right">572.00</td>
<td align="right">594.00</td>
</tr>
<tr class="even">
<td>GPA</td>
<td align="right">3.39</td>
<td align="right">3.3</td>
<td align="right">2.81</td>
<td align="right">3.03</td>
<td align="right">3.44</td>
<td align="right">3.07</td>
<td align="right">3</td>
<td align="right">3.43</td>
<td align="right">3.36</td>
<td align="right">3.13</td>
<td align="right">3.12</td>
<td align="right">2.74</td>
<td align="right">2.76</td>
<td align="right">2.88</td>
<td align="right">2.96</td>
</tr>
</tbody>
</table>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic.</p>
<p></font></p>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p><font size="3"> <bra></bra></p>
<p><strong><em>step1</em></strong></p>
<p>Define the ith jackknife sample<span class="math inline">\(x_{(i)}\)</span> to be the subset of <span class="math inline">\(x\)</span> that leaves out the ith observation <span class="math inline">\(x_i\)</span>.</p>
<p>That is, <span class="math inline">\(x_{(i)} = (x_1,\ldots,x_{i-1}, x_{i+1},\ldots,x_n)\)</span>.</p>
<p><bra></bra></p>
<p><strong><em>step2</em></strong></p>
<p><span class="math inline">\(\hat{θ} = T_n(x)\)</span>,define the ith jackknife replicate <span class="math inline">\(\hatθ_{(i)} = T_{n-1}(x_{(i)}), i = 1,\ldots,n\)</span>.</p>
<p><bra></bra></p>
<p><strong><em>step3</em></strong></p>
<p><span class="math inline">\(bias=E(\hat{\theta}-\theta)\)</span>, <span class="math inline">\(\hat{bias}_{jack}=(n-1)E(\overline{\hat{\theta}^{\star}}-\hat{\theta})\)</span></p>
<p><span class="math inline">\(\hat{se}_{jack}=\sqrt{(n-1)/n \sum_{i=1}^n(\bar{\hat{\theta}^{\star}}-\hat{\theta}_{i})^2}\)</span></p>
<p>The Jackknife estimate of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat{\theta}_{jack}=\hat{\theta}-\hat{bias}_{jack}\)</span></p>
<p><bra></bra><bra></bra><bra></bra></p>
<p><strong>The code and the result is shown as below:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
x &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT; y&lt;-law<span class="op">$</span>GPA
cor &lt;-<span class="st"> </span><span class="kw">cor</span>(x,y)
n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
cor_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)  <span class="co">#storage of the resamples</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
  cor_jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x[<span class="op">-</span>i],y[<span class="op">-</span>i]) 

bias.jack &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(cor_jack)<span class="op">-</span>cor)

se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">sum</span>((cor_jack<span class="op">-</span><span class="kw">mean</span>(cor_jack)))<span class="op">^</span><span class="dv">2</span>)
<span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">cor=</span> cor ,<span class="dt">est=</span>cor<span class="op">-</span>bias.jack, <span class="dt">bias =</span> bias.jack,<span class="dt">se =</span> se.jack, <span class="dt">cv =</span> bias.jack<span class="op">/</span>se.jack))
<span class="co">#&gt; $cor</span>
<span class="co">#&gt; [1] 0.7763745</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $est</span>
<span class="co">#&gt; [1] 0.7828481</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bias</span>
<span class="co">#&gt; [1] -0.006473623</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $se</span>
<span class="co">#&gt; [1] 2.145155e-16</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cv</span>
<span class="co">#&gt; [1] -3.017788e+13</span></code></pre></div>
<p><strong>We can find that in the 15 jackknife repeats, <span class="math inline">\(\hat{bias}_{jack}\)</span> is very small and the estimated coefficient of variation is far lower than 0.25.</strong> <font></p>
</div>
<div id="exercises-7.5-pages-212" class="section level2">
<h2>Exercises 7.5 (pages 212)</h2>
<p><font size="3"> Refer to the air-conditioning data set aircondit provided in the boot package. The 12 observations are the times in hours between failures of air conditioning equipment: 3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487. Assume that the times between failures follow an exponential model Exp(<span class="math inline">\(\lambda\)</span>).</p>
<p>Compute 95% bootstrap confidence intervals for themean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile,and BCa methods. Compare the intervals and explain why they may differ. <font></p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p><font size="3"> <bra></bra></p>
<p><strong><em>step1</em></strong> <span class="math inline">\(\frac{1}{\lambda}\)</span>is the mean value, so we use the data to resample and compute the mean.</p>
<p><strong><em>step2</em></strong> Use bootstrap to estimate the bias and standard error of the estimate <span class="math inline">\(\frac{1}{\lambda}\)</span>.</p>
<p><strong><em>step3</em></strong> Use R function boot.ci{boot}: basic, normal, percentile and BCa.</p>
<p><bra></bra></p>
<p><bra></bra><bra></bra><bra></bra></p>
<p><strong>The code and the result is shown as below:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Bootstrap</span>
<span class="kw">library</span>(boot)
<span class="kw">data</span>(aircondit,<span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)
air &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours
theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(air)
<span class="co">#set up the bootstrap</span>
B &lt;-<span class="st"> </span><span class="dv">2000</span>            <span class="co">#number of replicates</span>
n &lt;-<span class="st"> </span><span class="kw">length</span>(air)      <span class="co">#sample size</span>
theta.b &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)     <span class="co">#storage for replicates</span>

<span class="co">#bootstrap estimate of standard error of R</span>
<span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {
  <span class="co">#randomly select the indices</span>
  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
  dat &lt;-<span class="st"> </span>air[i]       <span class="co">#i is a vector of indices</span>
  theta.b[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(dat)
}

bias.theta &lt;-<span class="st"> </span><span class="kw">mean</span>(theta.b <span class="op">-</span><span class="st"> </span>theta.hat)
se &lt;-<span class="st"> </span><span class="kw">sd</span>(theta.b)

<span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">bias.b =</span> bias.theta,<span class="dt">se.b =</span> se))
<span class="co">#&gt; $bias.b</span>
<span class="co">#&gt; [1] 0.5493333</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $se.b</span>
<span class="co">#&gt; [1] 37.8041</span>

theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat,ind) {
  <span class="co">#function to compute the statistic</span>
  <span class="kw">mean</span>(dat[ind])
}
boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(air, <span class="dt">statistic =</span> theta.boot, <span class="dt">R =</span> <span class="dv">2000</span>)
<span class="kw">print</span>(boot.obj)
<span class="co">#&gt; </span>
<span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; boot(data = air, statistic = theta.boot, R = 2000)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrap Statistics :</span>
<span class="co">#&gt;     original     bias    std. error</span>
<span class="co">#&gt; t1* 108.0833 -0.7535833    37.97911</span></code></pre></div>
<p><strong>Here I use both of function I write and the boot function from package “boot” and get the value and bias and se of the bias.</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))
<span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span>
<span class="co">#&gt; Based on 2000 bootstrap replicates</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; CALL : </span>
<span class="co">#&gt; boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, </span>
<span class="co">#&gt;     &quot;bca&quot;))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Intervals : </span>
<span class="co">#&gt; Level      Normal              Basic         </span>
<span class="co">#&gt; 95%   ( 34.4, 183.3 )   ( 26.8, 171.1 )  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Level     Percentile            BCa          </span>
<span class="co">#&gt; 95%   ( 45.1, 189.4 )   ( 58.8, 231.9 )  </span>
<span class="co">#&gt; Calculations and Intervals on Original Scale</span>
<span class="co">#&gt; Some BCa intervals may be unstable</span></code></pre></div>
<p><strong>As is shown the intervals differ a lot because of transformation respecting and different order accuracy.</strong></p>
<p>The BCa confidence intervals are transformation respecting and BCa intervals have second order accuracy. Transformation respecting means that if <span class="math inline">\((\hat{θ}^*_{\alpha1}, \hat{θ}^*_{\alpha2})\)</span> is a confidence interval for <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(t(\theta)\)</span> is a transformation of the parameter <span class="math inline">\(\theta\)</span>, here <span class="math inline">\(\theta = \frac{1}{\lambda}\)</span>, then the corresponding interval for <span class="math inline">\(t(\theta)\)</span> is <span class="math inline">\((t(\hat{\theta}^*_{\alpha1}),t(\hat{\theta}^*_{\alpha2}))\)</span>. A confidence interval is first order accurate if the error tends to zero at rate <span class="math inline">\(1/\sqrt{n}\)</span> for sample size <span class="math inline">\(n\)</span>, and second order accurate if the error tends to zero at rate <span class="math inline">\(1/n\)</span>. The bootstrap percentile interval is transformation respecting but only first order accurate. The standard normal confidence interval is neither transformation respecting nor second order accurate.</p>
<p><font></p>
</div>
<div id="exercises-7.8-pages-213" class="section level2">
<h2>Exercises 7.8 (pages 213)</h2>
<p><font size="3"> Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>. <font></p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><font size="3"> <bra></bra></p>
<p>We need to use eigen function to get the eigen values and get the jackknife estimates. Then use the method to obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>: An unbiased estimate of the bias <span class="math inline">\(E(\hat\theta)-\theta_0\)</span> is <span class="math display">\[(n-1)(\bar{\hat\theta}_{(\cdot)}-\hat\theta)\]</span>. An unbiased estimate of <span class="math inline">\(se(\hat\theta)\)</span> is <span class="math display">\[ \sqrt{\frac{n-1}n\sum_{i=1}^n(\hat\theta_{(i)}-\bar{\hat\theta}_{(\cdot)})^2}\]</span></p>
<p><bra></bra></p>
<p><bra></bra><bra></bra><bra></bra></p>
<p><strong>The code and the result is shown as below:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Jackknife</span>
<span class="co">#compute the jackknife replicates, leave-one-out estimates</span>
<span class="kw">library</span>(bootstrap)
<span class="kw">data</span>(scor,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(scor<span class="op">$</span>mec, scor<span class="op">$</span>vec, scor<span class="op">$</span>alg, scor<span class="op">$</span>ana, scor<span class="op">$</span>sta)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  sigma.jack &lt;-<span class="st"> </span><span class="kw">cov</span>(dat[<span class="op">-</span>i,])
  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma.jack)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(sigma.jack)<span class="op">$</span>values)
}

<span class="co">#jackknife estimate of bias</span>
bias.jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat) 

<span class="co">#Jackknife estimate of standard error</span>
se.j &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))

<span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">bias.jack =</span> bias.jack,<span class="dt">se.jack =</span> se.j))
<span class="co">#&gt; $bias.jack</span>
<span class="co">#&gt; [1] -1182.189</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $se.jack</span>
<span class="co">#&gt; [1] 0.01729389</span></code></pre></div>
<p><strong>Numerical results show that the bias is big becaause of big (n-1) but the method will be more accurate because the se is quite small. </strong></p>
<p><font></p>
</div>
<div id="exercises-7.11-pages-213" class="section level2">
<h2>Exercises 7.11 (pages 213)</h2>
<p><font size="3"> In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models. <font></p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><font size="3"> <bra></bra></p>
<p><strong><em>step1</em></strong></p>
<p>We need to delete two data from datasets on which interpolation is to be done and to search the optimal shape parameter.</p>
<p>For <span class="math inline">\(k,j = 1,\ldots,n\)</span>, let observation <span class="math inline">\((x_k, y_k),(x_j,y_j),k\neq j\)</span> be the test points and use the remaining observations to fit the model.</p>
<p>For each <span class="math inline">\(x_i, i= 1,\ldots,n\)</span>, it will be used as test points for n times.</p>
<p>Compute the predicted response <span class="math inline">\(\hat{y_{i,k}} = \hat{\beta}_0 +\hat{ \beta}_1x_{i,k}\)</span> for the test point.</p>
<p>Compute the prediction error <span class="math inline">\(e_{i,k} = y_{k} ??? \hat{y}_{i,k}\)</span>.</p>
<p><strong><em>step2</em></strong></p>
<p>Estimate the mean of the squared prediction errors <span class="math inline">\(\hat{\sigma_{\epsilon}}^2=\frac{1}{n(n-1)}\sum{e^2_{i,k}}\)</span></p>
<p><strong><em>step3</em></strong></p>
<p>Compare the calculation accuracy of the two methods.</p>
<p><bra></bra></p>
<p><bra></bra><bra></bra><bra></bra></p>
<p><strong>The code and the result is shown as below:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>()

    <span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)
<span class="co">#&gt; The following objects are masked from ironslag (pos = 6):</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     chemical, magnetic</span>
    n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)   <span class="co">#in DAAG ironslag</span>
    e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n<span class="op">-</span><span class="dv">1</span>,n) <span class="co"># error matrix</span>
    <span class="co">#yhat1 &lt;- yhat2 &lt;- yhat3 &lt;- yhat4 &lt;- matrix(0,n-1,n)</span>
    <span class="co">#logyhat3 &lt;- logyhat4 &lt;- matrix(0,n-1,n)</span>
    
    
    <span class="co"># for n-fold cross validation</span>
    <span class="co"># fit models on leave-two-out samples</span>
    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n<span class="op">-</span><span class="dv">1</span>) {
      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
        <span class="cf">if</span> (j <span class="op">!=</span><span class="st"> </span>i){
          y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]
          x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]
          
          J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) 
          yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]
          e1[i,j] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1
          
          J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
          yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span>
<span class="st">            </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span>
          e2[i,j] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat2
          
          J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
          logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]
          yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
          e3[i,j] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat3
          
          J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
          logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i])
          yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)
          e4[i,j] &lt;-<span class="st"> </span>magnetic[i]<span class="op">-</span><span class="st"> </span>yhat4
        }
      }
    }
    
ltocv &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))
ltocv.ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>() <span class="op">-</span><span class="st"> </span>ptm <span class="co"># same function with system.time(exp)</span>
<span class="kw">print</span>(<span class="kw">list</span>(<span class="st">&quot;timeconsuming_of_ltocv&quot;</span>=ltocv.ptm[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]))
<span class="co">#&gt; $timeconsuming_of_ltocv</span>
<span class="co">#&gt; user.self  sys.self   elapsed </span>
<span class="co">#&gt;     10.74      0.00     10.74</span></code></pre></div>
<pre><code>#&gt; $timeconsuming_of_loocv
#&gt; user.self  sys.self   elapsed 
#&gt;      0.25      0.00      0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(loocv,ltocv))
<span class="kw">row.names</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;loocv&quot;</span>,<span class="st">&quot;ltocv&quot;</span>)
<span class="kw">names</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L3&quot;</span>,<span class="st">&quot;L4&quot;</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(a)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">L1</th>
<th align="right">L2</th>
<th align="right">L3</th>
<th align="right">L4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>loocv</td>
<td align="right">19.55644</td>
<td align="right">17.85248</td>
<td align="right">18.44188</td>
<td align="right">20.45424</td>
</tr>
<tr class="even">
<td>ltocv</td>
<td align="right">18.05208</td>
<td align="right">16.13677</td>
<td align="right">16.62082</td>
<td align="right">18.61243</td>
</tr>
</tbody>
</table>
<p>Homework10</p>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p>Make a faster version of chisq.test( ) that only computes the chi-square test statistic when the input is two numeric vectors with no missing values.</p>
</div>
<div id="answer-9" class="section level3">
<h3>answer</h3>
<p>In R, the function of chisq.test() as follow. let chisq.test1 denote chisq.test( ), we will try simplifying chisq.test( ).</p>
<p>chisq.test1=function (x, y = NULL, correct = TRUE, p = rep(1/length(x), length(x)), rescale.p = FALSE, simulate.p.value = FALSE, B = 2000) { DNAME &lt;- deparse(substitute(x)) if (is.data.frame(x)) x &lt;- as.matrix(x) if (is.matrix(x)) { if (min(dim(x)) == 1L) x &lt;- as.vector(x) } if (!is.matrix(x) &amp;&amp; !is.null(y)) { if (length(x) != length(y)) stop(“‘x’ and ‘y’ must have the same length”) DNAME2 &lt;- deparse(substitute(y)) xname &lt;- if (length(DNAME) &gt; 1L || nchar(DNAME, “w”) &gt; 30) “” else DNAME yname &lt;- if (length(DNAME2) &gt; 1L || nchar(DNAME2, “w”) &gt; 30) “” else DNAME2 OK &lt;- complete.cases(x, y) x &lt;- factor(x[OK]) y &lt;- factor(y[OK]) if ((nlevels(x) &lt; 2L) || (nlevels(y) &lt; 2L)) stop(“‘x’ and ‘y’ must have at least 2 levels”) x &lt;- table(x, y) names(dimnames(x)) &lt;- c(xname, yname) DNAME &lt;- paste(paste(DNAME, collapse = “”), “and”, paste(DNAME2, collapse = “”)) } if (any(x &lt; 0) || anyNA(x)) stop(“all entries of ‘x’ must be nonnegative and finite”) if ((n &lt;- sum(x)) == 0) stop(“at least one entry of ‘x’ must be positive”) if (simulate.p.value) { setMETH &lt;- function() METHOD &lt;&lt;- paste(METHOD, “with simulated p-value(based on”, B, “replicates)”) almost.1 &lt;- 1 - 64 * .Machine<span class="math inline">\(double.eps  }  if (is.matrix(x)) {  METHOD &lt;- &quot;Pearson's Chi-squared test&quot;  nr &lt;- as.integer(nrow(x))  nc &lt;- as.integer(ncol(x))  if (is.na(nr) || is.na(nc) || is.na(nr * nc))  stop(&quot;invalid nrow(x) or ncol(x)&quot;, domain = NA)  sr &lt;- rowSums(x)  sc &lt;- colSums(x)  E &lt;- outer(sr, sc, &quot;*&quot;)/n  v &lt;- function(r, c, n) c * r * (n - r) * (n - c)/n^3  V &lt;- outer(sr, sc, v, n)  dimnames(E) &lt;- dimnames(x)  if (simulate.p.value &amp;&amp; all(sr &gt; 0) &amp;&amp; all(sc &gt; 0)) {  setMETH()  tmp &lt;- .Call(C_chisq_sim, sr, sc, B, E)  STATISTIC &lt;- sum(sort((x - E)^2/E, decreasing = TRUE))  PARAMETER &lt;- NA  PVAL &lt;- (1 + sum(tmp &gt;= almost.1 * STATISTIC))/(B +  1)  }  else {  if (simulate.p.value)  warning(&quot;cannot compute simulated p-value with zero marginals&quot;)  if (correct &amp;&amp; nrow(x) == 2L &amp;&amp; ncol(x) == 2L) {  YATES &lt;- min(0.5, abs(x - E))  if (YATES &gt; 0)  METHOD &lt;- paste(METHOD, &quot;with Yates' continuity correction&quot;)  }  else YATES &lt;- 0  STATISTIC &lt;- sum((abs(x - E) - YATES)^2/E)  PARAMETER &lt;- (nr - 1L) * (nc - 1L)  PVAL &lt;- pchisq(STATISTIC, PARAMETER, lower.tail = FALSE)  }  }  else {  if (length(dim(x)) &gt; 2L)  stop(&quot;invalid 'x'&quot;)  if (length(x) == 1L)  stop(&quot;'x' must at least have 2 elements&quot;)  if (length(x) != length(p))  stop(&quot;'x' and 'p' must have the same number of elements&quot;)  if (any(p &lt; 0))  stop(&quot;probabilities must be non-negative.&quot;)  if (abs(sum(p) - 1) &gt; sqrt(.Machine\)</span>double.eps)) { if (rescale.p) p &lt;- p/sum(p) else stop(“probabilities must sum to 1.”) } METHOD &lt;- “Chi-squared test for given probabilities” E &lt;- n * p V &lt;- n * p * (1 - p) STATISTIC &lt;- sum((x - E)^2/E) names(E) &lt;- names(x) if (simulate.p.value) { setMETH() nx &lt;- length(x) sm &lt;- matrix(sample.int(nx, B * n, TRUE, prob = p), nrow = n) ss &lt;- apply(sm, 2L, function(x, E, k) { sum((table(factor(x, levels = 1L:k)) - E)^2/E) }, E = E, k = nx) PARAMETER &lt;- NA PVAL &lt;- (1 + sum(ss &gt;= almost.1 * STATISTIC))/(B + 1) } else { PARAMETER &lt;- length(x) - 1 PVAL &lt;- pchisq(STATISTIC, PARAMETER, lower.tail = FALSE) } } names(STATISTIC) &lt;- “X-squared” names(PARAMETER) &lt;- “df” if (any(E &lt; 5) &amp;&amp; is.finite(PARAMETER)) warning(“Chi-squared approximation may be incorrect”) structure(list(statistic = STATISTIC, parameter = PARAMETER, p.value = PVAL, method = METHOD, data.name = DNAME, observed = x, expected = E, residuals = (x - E)/sqrt(E), stdres = (x - E)/sqrt(V)), class = “htest”) }</p>
<p>Because the input is two numeric vectors with no missing values.</p>
<p>Firstly, this allows me to remove the is.data.frame( ) and is.matrix( ) test.</p>
<p>chisq.test2=function (x, y) { if (length(x) != length(y)) stop(“‘x’ and ‘y’ must have the same length”) OK &lt;- complete.cases(x, y) x &lt;- factor(x[OK]) y &lt;- factor(y[OK]) if ((nlevels(x) &lt; 2L) || (nlevels(y) &lt; 2L)) stop(“‘x’ and ‘y’ must have at least 2 levels”) x &lt;- table(x, y) n &lt;- sum(x) p = rep(1/length(x), length(x)) p &lt;- p/sum(p)</p>
<pre><code>    sr &lt;- rowSums(x)
    sc &lt;- colSums(x)
    E &lt;- outer(sr, sc, &quot;*&quot;)/n
    v &lt;- function(r, c, n) c * r * (n - r) * (n - c)/n^3
    V &lt;- outer(sr, sc, v, n)
    dimnames(E) &lt;- dimnames(x)
    STATISTIC &lt;- sum(sort((x - E)^2/E, decreasing = TRUE))
     STATISTIC 
  </code></pre>
<p>}</p>
<p>options(warn=-1) x &lt;- c(89,37,30,28,2,14,25) y &lt;- c(29,47,10,8,14,32,52)</p>
<p>chisq.test1(x,y)$statistic chisq.test2(x,y)</p>
<p>library(microbenchmark) microbenchmark( chisq.test1(x,y)$statistic, chisq.test2(x,y) )</p>
<p>It can be seen that chisq.test2( ) is much faster than chisq.test1( ) as twice.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>A footnote here.<a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
